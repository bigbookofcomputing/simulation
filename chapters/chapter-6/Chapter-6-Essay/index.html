
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A comprehensive guide to the foundations of stochastic simulation">
      
      
        <meta name="author" content="Big Book of Computing">
      
      
        <link rel="canonical" href="https://bigbookofcomputing.github.io/chapters/chapter-6/Chapter-6-Essay/">
      
      
        <link rel="prev" href="../../chapter-5/Chapter-5-Essay/">
      
      
        <link rel="next" href="../../chapter-7/Chapter-7-Essay/">
      
      
        
      
      
      <link rel="icon" href="../../../assets/logo.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Chapter-6 Advanced Monte Carlo Methods - Big Book of Computing | Simulation</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    
      <link rel="stylesheet" href="../../../static/styles.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-ECS7B3X8JM"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-ECS7B3X8JM",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-ECS7B3X8JM",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>if("undefined"!=typeof __md_analytics){var consent=__md_get("__consent");consent&&consent.analytics&&__md_analytics()}</script>
  

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#chapter-6-advanced-monte-carlo-methods" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Big Book of Computing | Simulation" class="md-header__button md-logo" aria-label="Big Book of Computing | Simulation" data-md-component="logo">
      
  <img src="../../../assets/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Big Book of Computing | Simulation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Chapter-6 Advanced Monte Carlo Methods
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1M8 13h8v-2H8zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4a5 5 0 0 0 5-5 5 5 0 0 0-5-5"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5M7 15a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/bigbookofcomputing/simulation" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../contents/" class="md-tabs__link">
        
  
  
    
  
  Contents

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../introduction/" class="md-tabs__link">
        
  
  
    
  
  Introduction

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../chapter-1/Chapter-1-Essay/" class="md-tabs__link">
          
  
  
    
  
  Chapters

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../chapter-1/Chapter-1-WorkBook/" class="md-tabs__link">
          
  
  
    
  
  WorkBooks

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../chapter-1/Chapter-1-CodeBook/" class="md-tabs__link">
          
  
  
    
  
  CodeBooks

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Big Book of Computing | Simulation" class="md-nav__button md-logo" aria-label="Big Book of Computing | Simulation" data-md-component="logo">
      
  <img src="../../../assets/logo.png" alt="logo">

    </a>
    Big Book of Computing | Simulation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/bigbookofcomputing/simulation" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contents/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Contents
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../introduction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Introduction
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Chapters
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Chapters
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-1/Chapter-1-Essay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-1 Foundations of Stochastic Simulation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-2/Chapter-2-Essay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-2 The Ising Model
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-3/Chapter-3-Essay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-3 Lattice Gauge Theory
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-4/Chapter-4-Essay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-4 Monte Carlo Option Pricing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-5/Chapter-5-Essay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-5 Stochastic Systems Biology
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Chapter-6 Advanced Monte Carlo Methods
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-6 Advanced Monte Carlo Methods
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      
        Introduction
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chapter-outline" class="md-nav__link">
    <span class="md-ellipsis">
      
        Chapter Outline
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#61-chapter-opener-escaping-the-energy-landscape" class="md-nav__link">
    <span class="md-ellipsis">
      
        6.1 Chapter Opener: Escaping the Energy Landscape
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6.1 Chapter Opener: Escaping the Energy Landscape">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#motivation-when-systems-get-stuck" class="md-nav__link">
    <span class="md-ellipsis">
      
        Motivation: When Systems Get Stuck
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-energy-landscape-picture" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Energy Landscape Picture
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a-simple-example-the-double-well-potential" class="md-nav__link">
    <span class="md-ellipsis">
      
        A Simple Example: The Double-Well Potential
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-cost-of-getting-stuck" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Cost of Getting Stuck
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#physical-intuition-escaping-metastable-states" class="md-nav__link">
    <span class="md-ellipsis">
      
        Physical Intuition: Escaping Metastable States
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#looking-ahead" class="md-nav__link">
    <span class="md-ellipsis">
      
        Looking Ahead
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#each-method-provides-a-different-path-to-escape-the-energy-landscape-allowing-simulations-to-explore-configuration-space-more-efficiently" class="md-nav__link">
    <span class="md-ellipsis">
      
        Each method provides a different path to escape the energy landscape — allowing simulations to explore configuration space more efficiently.
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Each method provides a different path to escape the energy landscape — allowing simulations to explore configuration space more efficiently.">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    <span class="md-ellipsis">
      
        Summary
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#62-cluster-algorithms-beating-critical-slowing-down" class="md-nav__link">
    <span class="md-ellipsis">
      
        6.2 Cluster Algorithms (Beating Critical Slowing Down)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6.2 Cluster Algorithms (Beating Critical Slowing Down)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#motivation-when-local-moves-fail" class="md-nav__link">
    <span class="md-ellipsis">
      
        Motivation: When Local Moves Fail
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-idea-of-collective-moves" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Idea of Collective Moves
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#building-a-cluster-wolff-algorithm" class="md-nav__link">
    <span class="md-ellipsis">
      
        Building a Cluster (Wolff Algorithm)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#implementation-example-2d-ising-model" class="md-nav__link">
    <span class="md-ellipsis">
      
        Implementation Example (2D Ising Model)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mathematical-insight-why-it-works" class="md-nav__link">
    <span class="md-ellipsis">
      
        Mathematical Insight: Why It Works
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#comparison-with-metropolis" class="md-nav__link">
    <span class="md-ellipsis">
      
        Comparison with Metropolis
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#summary_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Summary
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#63-parallel-tempering-escaping-local-minima" class="md-nav__link">
    <span class="md-ellipsis">
      
        6.3 Parallel Tempering (Escaping Local Minima)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6.3 Parallel Tempering (Escaping Local Minima)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#motivation-the-trap-of-rugged-landscapes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Motivation: The Trap of Rugged Landscapes
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-core-idea" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Core Idea
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#conceptual-picture" class="md-nav__link">
    <span class="md-ellipsis">
      
        Conceptual Picture
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#implementation-example-1d-double-well-system" class="md-nav__link">
    <span class="md-ellipsis">
      
        Implementation Example (1D Double-Well System)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#why-it-works" class="md-nav__link">
    <span class="md-ellipsis">
      
        Why It Works
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tuning-and-practical-notes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Tuning and Practical Notes
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#comparison-with-other-methods" class="md-nav__link">
    <span class="md-ellipsis">
      
        Comparison with Other Methods
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#summary_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Summary
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#64-the-wanglandau-algorithm-sampling-the-density-of-states" class="md-nav__link">
    <span class="md-ellipsis">
      
        6.4 The Wang–Landau Algorithm (Sampling the Density of States)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6.4 The Wang–Landau Algorithm (Sampling the Density of States)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#motivation-beyond-temperature-dependent-sampling" class="md-nav__link">
    <span class="md-ellipsis">
      
        Motivation: Beyond Temperature-Dependent Sampling
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-core-idea_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Core Idea
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mathematical-perspective" class="md-nav__link">
    <span class="md-ellipsis">
      
        Mathematical Perspective
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#implementation-example-1d-double-well-system_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Implementation Example: 1D Double-Well System
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#import-numpy-as-np-import-matplotlibpyplot-as-plt-def-ex-return-x4-2x2-discretize-energy-range-e_bins-nplinspace-15-20-100-g-npones_likee_bins-initial-guess-h-npzeros_likee_bins-f-npe-modification-factor-x-00-def-find_bine_val-return-npargminnpabse_bins-e_val-flatness_threshold-08-max_iter-1000000-for-step-in-rangemax_iter-propose-a-move-x_trial-x-nprandomuniform-05-05-ei-ej-ex-ex_trial-bi-bj-find_binei-find_binej-acceptance-rule-using-ge-if-nprandomrand-min1-gbigbj-x-x_trial-b-bj-else-b-bi-update-ge-and-histogram-gb-f-hb-1-periodic-check-for-flatness-if-step-5000-0-and-npminh-flatness_threshold-npmeanh-f-npsqrtf-h-0-if-f-npexp1e-8-break" class="md-nav__link">
    <span class="md-ellipsis">
      
        import numpy as np import matplotlib.pyplot as plt def E(x): return x**4 - 2*x**2 # Discretize energy range E_bins = np.linspace(-1.5, 2.0, 100) g = np.ones_like(E_bins) # initial guess H = np.zeros_like(E_bins) f = np.e # modification factor x = 0.0 def find_bin(E_val): return np.argmin(np.abs(E_bins - E_val)) flatness_threshold = 0.8 max_iter = 1000000 for step in range(max_iter): # Propose a move x_trial = x + np.random.uniform(-0.5, 0.5) Ei, Ej = E(x), E(x_trial) bi, bj = find_bin(Ei), find_bin(Ej) # Acceptance rule using g(E) if np.random.rand() &lt; min(1, g[bi]/g[bj]): x = x_trial b = bj else: b = bi # Update g(E) and histogram g[b] *= f H[b] += 1 # Periodic check for flatness if step % 5000 == 0 and np.min(H) &gt; flatness_threshold * np.mean(H): f = np.sqrt(f) H[:] = 0 if f &lt; np.exp(1e-8): break
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="import numpy as np import matplotlib.pyplot as plt def E(x): return x**4 - 2*x**2 # Discretize energy range E_bins = np.linspace(-1.5, 2.0, 100) g = np.ones_like(E_bins) # initial guess H = np.zeros_like(E_bins) f = np.e # modification factor x = 0.0 def find_bin(E_val): return np.argmin(np.abs(E_bins - E_val)) flatness_threshold = 0.8 max_iter = 1000000 for step in range(max_iter): # Propose a move x_trial = x + np.random.uniform(-0.5, 0.5) Ei, Ej = E(x), E(x_trial) bi, bj = find_bin(Ei), find_bin(Ej) # Acceptance rule using g(E) if np.random.rand() &lt; min(1, g[bi]/g[bj]): x = x_trial b = bj else: b = bi # Update g(E) and histogram g[b] *= f H[b] += 1 # Periodic check for flatness if step % 5000 == 0 and np.min(H) &gt; flatness_threshold * np.mean(H): f = np.sqrt(f) H[:] = 0 if f &lt; np.exp(1e-8): break">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#visualization-of-convergence" class="md-nav__link">
    <span class="md-ellipsis">
      
        Visualization of Convergence
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recovering-thermodynamic-quantities" class="md-nav__link">
    <span class="md-ellipsis">
      
        Recovering Thermodynamic Quantities
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#advantages-and-caveats" class="md-nav__link">
    <span class="md-ellipsis">
      
        Advantages and Caveats
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#summary_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        Summary
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#65-chapter-summary-bridge-to-part-ii" class="md-nav__link">
    <span class="md-ellipsis">
      
        6.5 Chapter Summary &amp; Bridge to Part II
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6.5 Chapter Summary &amp; Bridge to Part II">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-we-learned-escaping-the-energy-landscape" class="md-nav__link">
    <span class="md-ellipsis">
      
        What We Learned: Escaping the Energy Landscape
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#conceptual-thread-across-methods" class="md-nav__link">
    <span class="md-ellipsis">
      
        Conceptual Thread Across Methods
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#in-other-words-these-techniques-extend-monte-carlo-from-being-a-thermostat-to-being-an-exploration-engine" class="md-nav__link">
    <span class="md-ellipsis">
      
        In other words, these techniques extend Monte Carlo from being a thermostat to being an exploration engine.
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="In other words, these techniques extend Monte Carlo from being a thermostat to being an exploration engine.">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#from-monte-carlo-to-molecular-dynamics" class="md-nav__link">
    <span class="md-ellipsis">
      
        From Monte Carlo to Molecular Dynamics
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#looking-ahead_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Looking Ahead
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#takeaway" class="md-nav__link">
    <span class="md-ellipsis">
      
        Takeaway
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      
        References
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-7/Chapter-7-Essay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-7 Molecular Dynamics (MD)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-8/Chapter-8-Essay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-8 The Stochastic Calculus (SDEs)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-9/Chapter-9-Essay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-9 Black-Scholes-Merton (BSM)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-10/Chapter-10-Essay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-10 Neuroscience (Hodgkin-Huxley)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-11/Chapter-11-Essay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-11 Agent-Based & Network Models
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-12/Chapter-12-Essay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-12 Collective Behavior & Pattern Formation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-13/Chapter-13-Essay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-13 Collective Behavior & Pattern Formation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-14/Chapter-14-Essay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-14 Computational Neuroscience
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-15/Chapter-15-Essay.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-15 Graph and Network Models
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    WorkBooks
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    WorkBooks
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-1/Chapter-1-WorkBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-1 Foundations of Stochastic Simulation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-2/Chapter-2-WorkBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-2 The Ising Model
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-3/Chapter-3-WorkBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-3 Lattice Gauge Theory
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-4/Chapter-4-WorkBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-4 Monte Carlo Option Pricing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-5/Chapter-5-WorkBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-5 Stochastic Systems Biology
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Chapter-6-WorkBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-6 Advanced Monte Carlo Methods
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-7/Chapter-7-WorkBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-7 Molecular Dynamics (MD)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-8/Chapter-8-WorkBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-8 The Stochastic Calculus (SDEs)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-9/Chapter-9-WorkBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-9 Black-Scholes-Merton (BSM)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-10/Chapter-10-WorkBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-10 Neuroscience (Hodgkin-Huxley)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-11/Chapter-11-WorkBook" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-11 Agent-Based & Network Models
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-12/Chapter-12-WorkBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-12 Collective Behavior & Pattern Formation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-13/Chapter-13-WorkBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-13 Collective Behavior & Pattern Formation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-14/Chapter-14-WorkBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-14 Computational Neuroscience
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-15/Chapter-15-WorkBook.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-15 Graph and Network Models
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    CodeBooks
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    CodeBooks
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-1/Chapter-1-CodeBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-1 Foundations of Stochastic Simulation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-2/Chapter-2-CodeBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-2 The Ising Model
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-3/Chapter-3-CodeBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-3 Lattice Gauge Theory
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-4/Chapter-4-CodeBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-4 Monte Carlo Option Pricing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-5/Chapter-5-CodeBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-5 Stochastic Systems Biology
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Chapter-6-CodeBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-6 Advanced Monte Carlo Methods
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-7/Chapter-7-CodeBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-7 Molecular Dynamics (MD)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-8/Chapter-8-CodeBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-8 The Stochastic Calculus (SDEs)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-9/Chapter-9-CodeBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-9 Black-Scholes-Merton (BSM)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-10/Chapter-10-CodeBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-10 Neuroscience (Hodgkin-Huxley)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-11/Chapter-11-CodeBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-11 Agent-Based & Network Models
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-12/Chapter-12-CodeBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-12 Collective Behavior & Pattern Formation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-13/Chapter-13-CodeBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-13 Collective Behavior & Pattern Formation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-14/Chapter-14-CodeBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-14 Computational Neuroscience
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-15/Chapter-15-CodeBook.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-15 Graph and Network Models
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      
        Introduction
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chapter-outline" class="md-nav__link">
    <span class="md-ellipsis">
      
        Chapter Outline
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#61-chapter-opener-escaping-the-energy-landscape" class="md-nav__link">
    <span class="md-ellipsis">
      
        6.1 Chapter Opener: Escaping the Energy Landscape
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6.1 Chapter Opener: Escaping the Energy Landscape">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#motivation-when-systems-get-stuck" class="md-nav__link">
    <span class="md-ellipsis">
      
        Motivation: When Systems Get Stuck
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-energy-landscape-picture" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Energy Landscape Picture
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#a-simple-example-the-double-well-potential" class="md-nav__link">
    <span class="md-ellipsis">
      
        A Simple Example: The Double-Well Potential
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-cost-of-getting-stuck" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Cost of Getting Stuck
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#physical-intuition-escaping-metastable-states" class="md-nav__link">
    <span class="md-ellipsis">
      
        Physical Intuition: Escaping Metastable States
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#looking-ahead" class="md-nav__link">
    <span class="md-ellipsis">
      
        Looking Ahead
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#each-method-provides-a-different-path-to-escape-the-energy-landscape-allowing-simulations-to-explore-configuration-space-more-efficiently" class="md-nav__link">
    <span class="md-ellipsis">
      
        Each method provides a different path to escape the energy landscape — allowing simulations to explore configuration space more efficiently.
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Each method provides a different path to escape the energy landscape — allowing simulations to explore configuration space more efficiently.">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#summary" class="md-nav__link">
    <span class="md-ellipsis">
      
        Summary
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#62-cluster-algorithms-beating-critical-slowing-down" class="md-nav__link">
    <span class="md-ellipsis">
      
        6.2 Cluster Algorithms (Beating Critical Slowing Down)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6.2 Cluster Algorithms (Beating Critical Slowing Down)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#motivation-when-local-moves-fail" class="md-nav__link">
    <span class="md-ellipsis">
      
        Motivation: When Local Moves Fail
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-idea-of-collective-moves" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Idea of Collective Moves
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#building-a-cluster-wolff-algorithm" class="md-nav__link">
    <span class="md-ellipsis">
      
        Building a Cluster (Wolff Algorithm)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#implementation-example-2d-ising-model" class="md-nav__link">
    <span class="md-ellipsis">
      
        Implementation Example (2D Ising Model)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mathematical-insight-why-it-works" class="md-nav__link">
    <span class="md-ellipsis">
      
        Mathematical Insight: Why It Works
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#comparison-with-metropolis" class="md-nav__link">
    <span class="md-ellipsis">
      
        Comparison with Metropolis
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#summary_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Summary
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#63-parallel-tempering-escaping-local-minima" class="md-nav__link">
    <span class="md-ellipsis">
      
        6.3 Parallel Tempering (Escaping Local Minima)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6.3 Parallel Tempering (Escaping Local Minima)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#motivation-the-trap-of-rugged-landscapes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Motivation: The Trap of Rugged Landscapes
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-core-idea" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Core Idea
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#conceptual-picture" class="md-nav__link">
    <span class="md-ellipsis">
      
        Conceptual Picture
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#implementation-example-1d-double-well-system" class="md-nav__link">
    <span class="md-ellipsis">
      
        Implementation Example (1D Double-Well System)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#why-it-works" class="md-nav__link">
    <span class="md-ellipsis">
      
        Why It Works
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tuning-and-practical-notes" class="md-nav__link">
    <span class="md-ellipsis">
      
        Tuning and Practical Notes
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#comparison-with-other-methods" class="md-nav__link">
    <span class="md-ellipsis">
      
        Comparison with Other Methods
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#summary_2" class="md-nav__link">
    <span class="md-ellipsis">
      
        Summary
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#64-the-wanglandau-algorithm-sampling-the-density-of-states" class="md-nav__link">
    <span class="md-ellipsis">
      
        6.4 The Wang–Landau Algorithm (Sampling the Density of States)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6.4 The Wang–Landau Algorithm (Sampling the Density of States)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#motivation-beyond-temperature-dependent-sampling" class="md-nav__link">
    <span class="md-ellipsis">
      
        Motivation: Beyond Temperature-Dependent Sampling
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-core-idea_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Core Idea
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mathematical-perspective" class="md-nav__link">
    <span class="md-ellipsis">
      
        Mathematical Perspective
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#implementation-example-1d-double-well-system_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Implementation Example: 1D Double-Well System
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#import-numpy-as-np-import-matplotlibpyplot-as-plt-def-ex-return-x4-2x2-discretize-energy-range-e_bins-nplinspace-15-20-100-g-npones_likee_bins-initial-guess-h-npzeros_likee_bins-f-npe-modification-factor-x-00-def-find_bine_val-return-npargminnpabse_bins-e_val-flatness_threshold-08-max_iter-1000000-for-step-in-rangemax_iter-propose-a-move-x_trial-x-nprandomuniform-05-05-ei-ej-ex-ex_trial-bi-bj-find_binei-find_binej-acceptance-rule-using-ge-if-nprandomrand-min1-gbigbj-x-x_trial-b-bj-else-b-bi-update-ge-and-histogram-gb-f-hb-1-periodic-check-for-flatness-if-step-5000-0-and-npminh-flatness_threshold-npmeanh-f-npsqrtf-h-0-if-f-npexp1e-8-break" class="md-nav__link">
    <span class="md-ellipsis">
      
        import numpy as np import matplotlib.pyplot as plt def E(x): return x**4 - 2*x**2 # Discretize energy range E_bins = np.linspace(-1.5, 2.0, 100) g = np.ones_like(E_bins) # initial guess H = np.zeros_like(E_bins) f = np.e # modification factor x = 0.0 def find_bin(E_val): return np.argmin(np.abs(E_bins - E_val)) flatness_threshold = 0.8 max_iter = 1000000 for step in range(max_iter): # Propose a move x_trial = x + np.random.uniform(-0.5, 0.5) Ei, Ej = E(x), E(x_trial) bi, bj = find_bin(Ei), find_bin(Ej) # Acceptance rule using g(E) if np.random.rand() &lt; min(1, g[bi]/g[bj]): x = x_trial b = bj else: b = bi # Update g(E) and histogram g[b] *= f H[b] += 1 # Periodic check for flatness if step % 5000 == 0 and np.min(H) &gt; flatness_threshold * np.mean(H): f = np.sqrt(f) H[:] = 0 if f &lt; np.exp(1e-8): break
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="import numpy as np import matplotlib.pyplot as plt def E(x): return x**4 - 2*x**2 # Discretize energy range E_bins = np.linspace(-1.5, 2.0, 100) g = np.ones_like(E_bins) # initial guess H = np.zeros_like(E_bins) f = np.e # modification factor x = 0.0 def find_bin(E_val): return np.argmin(np.abs(E_bins - E_val)) flatness_threshold = 0.8 max_iter = 1000000 for step in range(max_iter): # Propose a move x_trial = x + np.random.uniform(-0.5, 0.5) Ei, Ej = E(x), E(x_trial) bi, bj = find_bin(Ei), find_bin(Ej) # Acceptance rule using g(E) if np.random.rand() &lt; min(1, g[bi]/g[bj]): x = x_trial b = bj else: b = bi # Update g(E) and histogram g[b] *= f H[b] += 1 # Periodic check for flatness if step % 5000 == 0 and np.min(H) &gt; flatness_threshold * np.mean(H): f = np.sqrt(f) H[:] = 0 if f &lt; np.exp(1e-8): break">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#visualization-of-convergence" class="md-nav__link">
    <span class="md-ellipsis">
      
        Visualization of Convergence
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recovering-thermodynamic-quantities" class="md-nav__link">
    <span class="md-ellipsis">
      
        Recovering Thermodynamic Quantities
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#advantages-and-caveats" class="md-nav__link">
    <span class="md-ellipsis">
      
        Advantages and Caveats
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#summary_3" class="md-nav__link">
    <span class="md-ellipsis">
      
        Summary
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#65-chapter-summary-bridge-to-part-ii" class="md-nav__link">
    <span class="md-ellipsis">
      
        6.5 Chapter Summary &amp; Bridge to Part II
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6.5 Chapter Summary &amp; Bridge to Part II">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-we-learned-escaping-the-energy-landscape" class="md-nav__link">
    <span class="md-ellipsis">
      
        What We Learned: Escaping the Energy Landscape
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#conceptual-thread-across-methods" class="md-nav__link">
    <span class="md-ellipsis">
      
        Conceptual Thread Across Methods
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#in-other-words-these-techniques-extend-monte-carlo-from-being-a-thermostat-to-being-an-exploration-engine" class="md-nav__link">
    <span class="md-ellipsis">
      
        In other words, these techniques extend Monte Carlo from being a thermostat to being an exploration engine.
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="In other words, these techniques extend Monte Carlo from being a thermostat to being an exploration engine.">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#from-monte-carlo-to-molecular-dynamics" class="md-nav__link">
    <span class="md-ellipsis">
      
        From Monte Carlo to Molecular Dynamics
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#looking-ahead_1" class="md-nav__link">
    <span class="md-ellipsis">
      
        Looking Ahead
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#takeaway" class="md-nav__link">
    <span class="md-ellipsis">
      
        Takeaway
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      
        References
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
    <a href="https://github.com/bigbookofcomputing/simulation/edit/master/docs/chapters/chapter-6/Chapter-6-Essay.md" title="Edit this page" class="md-content__button md-icon" rel="edit">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/bigbookofcomputing/simulation/raw/master/docs/chapters/chapter-6/Chapter-6-Essay.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg>
    </a>
  


<h1 id="chapter-6-advanced-monte-carlo-methods"><strong>Chapter 6: Advanced Monte Carlo Methods</strong></h1>
<hr />
<h2 id="introduction"><strong>Introduction</strong></h2>
<p>While the Metropolis–Hastings algorithm provides a robust foundation for stochastic sampling, it faces fundamental obstacles when confronted with complex energy landscapes. Near critical points, systems develop long-range correlations that render single-spin updates ineffective—a phenomenon known as <strong>critical slowing down</strong> where correlation times diverge as <span class="arithmatex">\(\tau \sim \xi^z\)</span> with dynamic exponent <span class="arithmatex">\(z \approx 2\)</span>. In rugged landscapes with multiple local minima separated by high energy barriers <span class="arithmatex">\(\Delta E\)</span>, thermal activation rates scale as <span class="arithmatex">\(\sim e^{-\beta \Delta E}\)</span>, trapping the simulation in metastable states for exponentially long times. Traditional MCMC thus becomes computationally prohibitive precisely where we need it most: exploring phase transitions, rare events, and complex free energy surfaces.</p>
<p>This chapter introduces three advanced Monte Carlo methods that fundamentally reshape how we navigate configuration space. <strong>Cluster algorithms</strong> (such as Swendsen–Wang and Wolff) flip correlated regions of spins collectively, achieving dynamic exponents <span class="arithmatex">\(z &lt; 1\)</span> that eliminate critical slowing down near <span class="arithmatex">\(T_c\)</span>. <strong>Parallel tempering</strong> (replica exchange) runs multiple copies of the system at different temperatures, allowing high-temperature replicas to escape local minima and transfer configurations to low-temperature replicas through Metropolis-style swaps. The <strong>Wang–Landau algorithm</strong> abandons fixed-temperature sampling entirely, instead estimating the density of states <span class="arithmatex">\(g(E)\)</span> directly through adaptive histogram flattening—enabling computation of thermodynamic observables at all temperatures from a single simulation. Each method represents a distinct philosophical shift: from local to collective updates, from single to multi-temperature ensembles, and from Boltzmann weights to landscape reconstruction.</p>
<p>By the end of this chapter, you will understand when and why standard MCMC fails, and possess a powerful toolkit for overcoming these limitations. Through concrete implementations for the 2D Ising model, protein folding energy landscapes, and glassy systems, you will see how advanced sampling methods transform intractable problems into computationally feasible ones. These techniques extend far beyond spin systems—cluster moves accelerate polymer simulations, replica exchange powers protein structure prediction, and flat-histogram methods probe rare event statistics in materials science and biophysics. Mastering these algorithms equips you to tackle the most challenging sampling problems in computational physics.</p>
<hr />
<h2 id="chapter-outline"><strong>Chapter Outline</strong></h2>
<table>
<thead>
<tr>
<th style="text-align: left;"><strong>Sec.</strong></th>
<th style="text-align: left;"><strong>Title</strong></th>
<th style="text-align: left;"><strong>Core Ideas &amp; Examples</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><strong>6.1</strong></td>
<td style="text-align: left;">Escaping the Energy Landscape</td>
<td style="text-align: left;"><strong>Metastability &amp; energy barriers</strong>: Double-well potential <span class="arithmatex">\(V(x) = x^4 - 2x^2\)</span>, barrier crossing <span class="arithmatex">\(\sim e^{-\beta \Delta E}\)</span>. <strong>Critical slowing down</strong>: Ising model correlation time <span class="arithmatex">\(\tau \sim \xi^{2.17}\)</span> near <span class="arithmatex">\(T_c\)</span>. Visualization of Metropolis getting trapped in local minima.</td>
</tr>
<tr>
<td style="text-align: left;"><strong>6.2</strong></td>
<td style="text-align: left;">Cluster Algorithms</td>
<td style="text-align: left;"><strong>Swendsen–Wang &amp; Wolff algorithms</strong>: Bond probability <span class="arithmatex">\(p_{\text{bond}} = 1 - e^{-2\beta J}\)</span>, collective spin flips. <strong>Dynamic exponent</strong>: <span class="arithmatex">\(z &lt; 1\)</span> eliminates critical slowing down. Implementation for 2D Ising model, cluster size distribution.</td>
</tr>
<tr>
<td style="text-align: left;"><strong>6.3</strong></td>
<td style="text-align: left;">Parallel Tempering</td>
<td style="text-align: left;"><strong>Replica exchange</strong>: Swap acceptance <span class="arithmatex">\(P_{\text{swap}} = \min(1, e^{(\beta_i - \beta_j)(E_j - E_i)})\)</span>, temperature ladder design. <strong>Application to rugged landscapes</strong>: Protein folding energy surfaces, glass transitions. Exchange rates and temperature selection strategies.</td>
</tr>
<tr>
<td style="text-align: left;"><strong>6.4</strong></td>
<td style="text-align: left;">Wang–Landau Algorithm</td>
<td style="text-align: left;"><strong>Density of states</strong>: <span class="arithmatex">\(g(E)\)</span> estimation via flat histogram, partition function <span class="arithmatex">\(Z(\beta) = \sum_E g(E) e^{-\beta E}\)</span>. <strong>Adaptive refinement</strong>: Modification factor <span class="arithmatex">\(f \to \sqrt{f}\)</span>, convergence to <span class="arithmatex">\(\ln g(E)\)</span>. Thermodynamics at all temperatures from single run.</td>
</tr>
<tr>
<td style="text-align: left;"><strong>6.5</strong></td>
<td style="text-align: left;">Chapter Summary &amp; Bridge</td>
<td style="text-align: left;"><strong>Conceptual unification</strong>: From local to collective exploration, single to multi-<span class="arithmatex">\(T\)</span> ensembles, Boltzmann to landscape mapping. Connection to molecular dynamics (Part II), rare event sampling, and free energy methods.</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="61-chapter-opener-escaping-the-energy-landscape"><strong>6.1 Chapter Opener: Escaping the Energy Landscape</strong></h2>
<hr />
<h3 id="motivation-when-systems-get-stuck"><strong>Motivation: When Systems Get Stuck</strong></h3>
<p>In previous chapters, we explored how randomness helps us understand physical systems — from diffusion to stochastic gene expression. But randomness can also work <em>against</em> us.
When exploring a <strong>complex energy landscape</strong>, a simulation can easily get trapped in a local minimum and fail to reach equilibrium.</p>
<p>Think of a rugged mountain range 🌄: a hiker wandering randomly may fall into a valley and never climb out, even though a much deeper valley (the true equilibrium) lies nearby.</p>
<p>This problem — <strong>critical slowing down</strong> or <strong>metastability</strong> — becomes severe near phase transitions or in systems with competing interactions.</p>
<hr />
<h3 id="the-energy-landscape-picture"><strong>The Energy Landscape Picture</strong></h3>
<p>For a configuration <span class="arithmatex">\(X\)</span>, the energy <span class="arithmatex">\(E(X)\)</span> defines a landscape over the space of all possible states.
We can imagine every configuration as a point in this space, with its height given by <span class="arithmatex">\(E(X)\)</span>.</p>
<p>If the simulation uses, for instance, the <strong>Metropolis algorithm</strong>, the probability of accepting a move from <span class="arithmatex">\(X\)</span> to <span class="arithmatex">\(X'\)</span> is</p>
<div class="arithmatex">\[
P_{\text{accept}} = \min!\left(1, e^{-\beta [E(X') - E(X)]}\right),
\]</div>
<p>where <span class="arithmatex">\(\beta = 1/(k_B T)\)</span> controls how easily the system crosses energy barriers.
At low temperatures (large <span class="arithmatex">\(\beta\)</span>), the system becomes <em>sticky</em> — it rarely escapes high barriers.</p>
<hr />
<h3 id="a-simple-example-the-double-well-potential"><strong>A Simple Example: The Double-Well Potential</strong></h3>
<p>Let’s visualize a simple one-dimensional system with two minima — a toy model for metastability.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="c1"># Define double-well potential</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="k">def</span><span class="w"> </span><span class="nf">E</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>    <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span>  <span class="c1"># Two wells at x = ±1</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">2.5</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mi">400</span><span class="p">)</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">E</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Double-Well Energy Landscape&quot;</span><span class="p">)</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;$x$&quot;</span><span class="p">)</span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;$E(x)$&quot;</span><span class="p">)</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></code></pre></div>
<p><em>Discussion:</em>
At high <span class="arithmatex">\(T\)</span>, random fluctuations allow transitions between wells.
At low <span class="arithmatex">\(T\)</span>, the system can remain stuck in one well for a long time — even though both states have equal energy.</p>
<hr />
<h3 id="the-cost-of-getting-stuck"><strong>The Cost of Getting Stuck</strong></h3>
<p>Let’s simulate a naive random walk on this landscape and see what happens.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="k">def</span><span class="w"> </span><span class="nf">metropolis</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="mi">10000</span><span class="p">,</span> <span class="n">step_size</span><span class="o">=</span><span class="mf">0.5</span><span class="p">):</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">steps</span><span class="p">)</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>    <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">x0</span>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">steps</span><span class="p">):</span>
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>        <span class="n">x_trial</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="n">step_size</span><span class="p">,</span> <span class="n">step_size</span><span class="p">)</span>
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a>        <span class="n">dE</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="n">x_trial</span><span class="p">)</span> <span class="o">-</span> <span class="n">E</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a>        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">beta</span> <span class="o">*</span> <span class="n">dE</span><span class="p">)</span> <span class="ow">or</span> <span class="n">dE</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="__span-1-10"><a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a>            <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">x_trial</span>
</span><span id="__span-1-11"><a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="__span-1-12"><a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a>            <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</span><span id="__span-1-13"><a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a>    <span class="k">return</span> <span class="n">x</span>
</span><span id="__span-1-14"><a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a>
</span><span id="__span-1-15"><a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a><span class="n">x_traj</span> <span class="o">=</span> <span class="n">metropolis</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="mf">5.0</span><span class="p">)</span>
</span><span id="__span-1-16"><a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x_traj</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="__span-1-17"><a id="__codelineno-1-17" name="__codelineno-1-17" href="#__codelineno-1-17"></a><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Metropolis Simulation in a Double-Well Potential&quot;</span><span class="p">)</span>
</span><span id="__span-1-18"><a id="__codelineno-1-18" name="__codelineno-1-18" href="#__codelineno-1-18"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Step&quot;</span><span class="p">)</span>
</span><span id="__span-1-19"><a id="__codelineno-1-19" name="__codelineno-1-19" href="#__codelineno-1-19"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;$x$&quot;</span><span class="p">)</span>
</span><span id="__span-1-20"><a id="__codelineno-1-20" name="__codelineno-1-20" href="#__codelineno-1-20"></a><span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-1-21"><a id="__codelineno-1-21" name="__codelineno-1-21" href="#__codelineno-1-21"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></code></pre></div>
<p>You’ll see that the walker gets trapped around one well — it rarely crosses to the other side.
This illustrates why <strong>advanced sampling algorithms</strong> are essential.</p>
<hr />
<h3 id="physical-intuition-escaping-metastable-states"><strong>Physical Intuition: Escaping Metastable States</strong></h3>
<p>To escape from one minimum to another, the system must cross an <strong>energy barrier</strong> <span class="arithmatex">\(\Delta E\)</span>.
According to Arrhenius-like kinetics, the escape rate behaves roughly as</p>
<div class="arithmatex">\[
k \sim e^{-\beta \Delta E}.
\]</div>
<p>This exponential dependence is what causes <em>critical slowing down</em>: as temperature drops or barriers rise, the simulation takes exponentially longer to equilibrate.</p>
<div class="admonition tip">
<p class="admonition-title">Barrier Crossing Rates and Temperature</p>
<p>The Arrhenius-like escape rate <span class="arithmatex">\(k \sim e^{-\beta \Delta E}\)</span> explains why simulations slow down dramatically at low temperatures:</p>
<ul>
<li>At <span class="arithmatex">\(T = 0.5\Delta E/k_B\)</span>: escape rate <span class="arithmatex">\(\sim e^{-2} \approx 0.14\)</span> (moderate)</li>
<li>At <span class="arithmatex">\(T = 0.1\Delta E/k_B\)</span>: escape rate <span class="arithmatex">\(\sim e^{-10} \approx 4.5 \times 10^{-5}\)</span> (very slow)</li>
</ul>
<p>This exponential scaling means that halving the temperature can increase equilibration time by orders of magnitude. Advanced methods overcome this by either: (1) flipping collective degrees of freedom (clusters), (2) borrowing mobility from high-T replicas (parallel tempering), or (3) flattening the landscape artificially (Wang-Landau).</p>
</div>
<hr />
<h3 id="looking-ahead"><strong>Looking Ahead</strong></h3>
<p>In this chapter, we’ll introduce <strong>three powerful methods</strong> to overcome these limitations:</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Method</th>
<th style="text-align: left;">Key Idea</th>
<th style="text-align: left;">Analogy</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><strong>Cluster Algorithms</strong></td>
<td style="text-align: left;">Flip correlated spins as a group</td>
<td style="text-align: left;">“Move whole valleys instead of pebbles”</td>
</tr>
<tr>
<td style="text-align: left;"><strong>Parallel Tempering</strong></td>
<td style="text-align: left;">Run replicas at multiple temperatures</td>
<td style="text-align: left;">“Let hot systems help cold ones escape”</td>
</tr>
<tr>
<td style="text-align: left;"><strong>Wang–Landau Sampling</strong></td>
<td style="text-align: left;">Flatten the energy histogram</td>
<td style="text-align: left;">“Climb hills as easily as descending them”</td>
</tr>
</tbody>
</table>
<h2 id="each-method-provides-a-different-path-to-escape-the-energy-landscape-allowing-simulations-to-explore-configuration-space-more-efficiently">Each method provides a different path to <em>escape the energy landscape</em> — allowing simulations to explore configuration space more efficiently.</h2>
<h3 id="summary"><strong>Summary</strong></h3>
<ul>
<li>Metastable states arise from <strong>energy barriers</strong> in rugged landscapes.</li>
<li>Standard Monte Carlo methods suffer from <strong>critical slowing down</strong>.</li>
<li>Escaping local minima requires <strong>algorithmic innovation</strong>.</li>
<li>The next sections present three modern strategies to achieve this.</li>
</ul>
<hr />
<h2 id="62-cluster-algorithms-beating-critical-slowing-down"><strong>6.2 Cluster Algorithms (Beating Critical Slowing Down)</strong></h2>
<hr />
<h3 id="motivation-when-local-moves-fail"><strong>Motivation: When Local Moves Fail</strong></h3>
<p>Near the critical point of a spin system (like the Ising model), neighboring spins become highly correlated.
A single-spin Metropolis update flips only one spin at a time — producing microscopic moves that barely change the overall configuration.</p>
<p>The result?
<strong>Critical slowing down</strong> — correlation times grow dramatically, and the system takes forever to decorrelate.</p>
<p>Cluster algorithms attack this head-on:</p>
<blockquote>
<p><em>Instead of moving one spin, move an entire correlated region at once.</em></p>
</blockquote>
<p>This collective motion lets the system traverse configuration space much more efficiently.</p>
<hr />
<h3 id="the-idea-of-collective-moves"><strong>The Idea of Collective Moves</strong></h3>
<p>Consider the Ising Hamiltonian</p>
<div class="arithmatex">\[
E(X) = -J \sum_{\langle i,j \rangle} s_i s_j,
\]</div>
<p>with <span class="arithmatex">\(s_i = \pm1\)</span> and <span class="arithmatex">\(\langle i,j\rangle\)</span> denoting nearest-neighbor pairs.</p>
<p>At the critical temperature, large domains of aligned spins form.
Flipping one spin costs an energy proportional to the <em>surface</em> of the domain, not its volume — so single-spin updates are inefficient.</p>
<p>Cluster algorithms (like <strong>Swendsen-Wang</strong> and <strong>Wolff</strong>) exploit these correlations by flipping <em>whole clusters</em> of spins that are likely to move together.</p>
<hr />
<h3 id="building-a-cluster-wolff-algorithm"><strong>Building a Cluster (Wolff Algorithm)</strong></h3>
<p>The <strong>Wolff algorithm</strong> is conceptually simple:</p>
<ol>
<li>Pick a random "seed" spin <span class="arithmatex">\(s_i\)</span>.</li>
<li>Add neighboring spins of the same sign <span class="arithmatex">\(s_j = s_i\)</span> to the cluster with probability
   $$
   p_\text{add} = 1 - e^{-2\beta J}.
   $$</li>
<li>Repeat step 2 recursively for all spins newly added to the cluster.</li>
<li>Flip the entire cluster: <span class="arithmatex">\(s_i \to -s_i\)</span> for all <span class="arithmatex">\(i\)</span> in the cluster.</li>
</ol>
<p>Because the bond-addition probability <span class="arithmatex">\(p_\text{add}\)</span> mimics the Boltzmann weight of aligned spins, the resulting move satisfies detailed balance automatically.</p>
<p><strong>Flowchart: Wolff Cluster Growth and Flip</strong></p>
<pre class="mermaid"><code>flowchart TD
    A[Start: Full Lattice] --&gt; B[Pick Random Seed Spin s_i]
    B --&gt; C[Initialize: cluster = {s_i}, stack = {s_i}]
    C --&gt; D{Stack Empty?}
    D --&gt;|Yes| K[Flip All Spins in Cluster]
    D --&gt;|No| E[Pop Spin from Stack]
    E --&gt; F[Get Neighbors of Current Spin]
    F --&gt; G{For Each Neighbor n}
    G --&gt; H{Same Sign as Seed?}
    H --&gt;|No| G
    H --&gt;|Yes| I{Already in Cluster?}
    I --&gt;|Yes| G
    I --&gt;|No| J{Random &lt; p_add?}
    J --&gt;|No| G
    J --&gt;|Yes| L[Add n to Cluster and Stack]
    L --&gt; G
    G --&gt;|All Neighbors Checked| D
    K --&gt; M[Return Updated Lattice]

    style A fill:#e1f5ff
    style B fill:#fff4e1
    style K fill:#ffe1e1
    style M fill:#e1ffe1</code></pre>
<hr />
<h3 id="implementation-example-2d-ising-model"><strong>Implementation Example (2D Ising Model)</strong></h3>
<p>Let's implement a minimal Wolff cluster update.</p>
<p><strong>Pseudo-code: Wolff Single-Cluster Algorithm</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>Algorithm: Wolff_Cluster_Update(lattice, beta, J)
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>  Input: spin lattice, inverse temperature β, coupling J
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>  Output: updated lattice after cluster flip
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>  1. seed ← random spin position in lattice
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>  2. cluster ← {seed}
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a>  3. stack ← [seed]  // positions to explore
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a>  4. p_add ← 1 - exp(-2*β*J)
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a>
</span><span id="__span-2-10"><a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a>  5. while stack is not empty:
</span><span id="__span-2-11"><a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a>       current ← pop(stack)
</span><span id="__span-2-12"><a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a>       for each neighbor n of current:
</span><span id="__span-2-13"><a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a>         if n ∉ cluster and lattice[n] == lattice[seed]:
</span><span id="__span-2-14"><a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a>           if random() &lt; p_add:
</span><span id="__span-2-15"><a id="__codelineno-2-15" name="__codelineno-2-15" href="#__codelineno-2-15"></a>             add n to cluster
</span><span id="__span-2-16"><a id="__codelineno-2-16" name="__codelineno-2-16" href="#__codelineno-2-16"></a>             push n onto stack
</span><span id="__span-2-17"><a id="__codelineno-2-17" name="__codelineno-2-17" href="#__codelineno-2-17"></a>
</span><span id="__span-2-18"><a id="__codelineno-2-18" name="__codelineno-2-18" href="#__codelineno-2-18"></a>  6. for each spin s in cluster:
</span><span id="__span-2-19"><a id="__codelineno-2-19" name="__codelineno-2-19" href="#__codelineno-2-19"></a>       flip lattice[s]
</span><span id="__span-2-20"><a id="__codelineno-2-20" name="__codelineno-2-20" href="#__codelineno-2-20"></a>
</span><span id="__span-2-21"><a id="__codelineno-2-21" name="__codelineno-2-21" href="#__codelineno-2-21"></a>  7. return lattice
</span></code></pre></div>
<p><strong>Python Implementation:</strong></p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="n">L</span> <span class="o">=</span> <span class="mi">50</span>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="n">J</span> <span class="o">=</span> <span class="mf">1.0</span>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="n">beta</span> <span class="o">=</span> <span class="mf">0.45</span>  <span class="c1"># near critical beta ≈ 0.4407 for 2D Ising</span>
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a><span class="n">p_add</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">beta</span> <span class="o">*</span> <span class="n">J</span><span class="p">)</span>
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a>
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a><span class="c1"># Initialize lattice randomly</span>
</span><span id="__span-3-10"><a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a><span class="n">spins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="n">L</span><span class="p">))</span>
</span><span id="__span-3-11"><a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a>
</span><span id="__span-3-12"><a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a><span class="k">def</span><span class="w"> </span><span class="nf">wolff_step</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">p_add</span><span class="p">):</span>
</span><span id="__span-3-13"><a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a>    <span class="n">L</span> <span class="o">=</span> <span class="n">spins</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="__span-3-14"><a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a>    <span class="n">visited</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
</span><span id="__span-3-15"><a id="__codelineno-3-15" name="__codelineno-3-15" href="#__codelineno-3-15"></a>
</span><span id="__span-3-16"><a id="__codelineno-3-16" name="__codelineno-3-16" href="#__codelineno-3-16"></a>    <span class="c1"># pick random seed</span>
</span><span id="__span-3-17"><a id="__codelineno-3-17" name="__codelineno-3-17" href="#__codelineno-3-17"></a>    <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">L</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">L</span><span class="p">)</span>
</span><span id="__span-3-18"><a id="__codelineno-3-18" name="__codelineno-3-18" href="#__codelineno-3-18"></a>    <span class="n">cluster_val</span> <span class="o">=</span> <span class="n">spins</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span>
</span><span id="__span-3-19"><a id="__codelineno-3-19" name="__codelineno-3-19" href="#__codelineno-3-19"></a>    <span class="n">cluster</span> <span class="o">=</span> <span class="p">[(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">)]</span>
</span><span id="__span-3-20"><a id="__codelineno-3-20" name="__codelineno-3-20" href="#__codelineno-3-20"></a>    <span class="n">visited</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="__span-3-21"><a id="__codelineno-3-21" name="__codelineno-3-21" href="#__codelineno-3-21"></a>
</span><span id="__span-3-22"><a id="__codelineno-3-22" name="__codelineno-3-22" href="#__codelineno-3-22"></a>    <span class="k">while</span> <span class="n">cluster</span><span class="p">:</span>
</span><span id="__span-3-23"><a id="__codelineno-3-23" name="__codelineno-3-23" href="#__codelineno-3-23"></a>        <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">cluster</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
</span><span id="__span-3-24"><a id="__codelineno-3-24" name="__codelineno-3-24" href="#__codelineno-3-24"></a>        <span class="k">for</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span> <span class="ow">in</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),(</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)]:</span>
</span><span id="__span-3-25"><a id="__codelineno-3-25" name="__codelineno-3-25" href="#__codelineno-3-25"></a>            <span class="n">xn</span><span class="p">,</span> <span class="n">yn</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="o">+</span><span class="n">dx</span><span class="p">)</span><span class="o">%</span><span class="n">L</span><span class="p">,</span> <span class="p">(</span><span class="n">y</span><span class="o">+</span><span class="n">dy</span><span class="p">)</span><span class="o">%</span><span class="n">L</span>
</span><span id="__span-3-26"><a id="__codelineno-3-26" name="__codelineno-3-26" href="#__codelineno-3-26"></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">visited</span><span class="p">[</span><span class="n">xn</span><span class="p">,</span> <span class="n">yn</span><span class="p">]</span> <span class="ow">and</span> <span class="n">spins</span><span class="p">[</span><span class="n">xn</span><span class="p">,</span> <span class="n">yn</span><span class="p">]</span> <span class="o">==</span> <span class="n">cluster_val</span><span class="p">:</span>
</span><span id="__span-3-27"><a id="__codelineno-3-27" name="__codelineno-3-27" href="#__codelineno-3-27"></a>                <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">p_add</span><span class="p">:</span>
</span><span id="__span-3-28"><a id="__codelineno-3-28" name="__codelineno-3-28" href="#__codelineno-3-28"></a>                    <span class="n">visited</span><span class="p">[</span><span class="n">xn</span><span class="p">,</span> <span class="n">yn</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="__span-3-29"><a id="__codelineno-3-29" name="__codelineno-3-29" href="#__codelineno-3-29"></a>                    <span class="n">cluster</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">xn</span><span class="p">,</span> <span class="n">yn</span><span class="p">))</span>
</span><span id="__span-3-30"><a id="__codelineno-3-30" name="__codelineno-3-30" href="#__codelineno-3-30"></a>    <span class="c1"># flip cluster</span>
</span><span id="__span-3-31"><a id="__codelineno-3-31" name="__codelineno-3-31" href="#__codelineno-3-31"></a>    <span class="n">spins</span><span class="p">[</span><span class="n">visited</span><span class="p">]</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>
</span><span id="__span-3-32"><a id="__codelineno-3-32" name="__codelineno-3-32" href="#__codelineno-3-32"></a>    <span class="k">return</span> <span class="n">spins</span>
</span><span id="__span-3-33"><a id="__codelineno-3-33" name="__codelineno-3-33" href="#__codelineno-3-33"></a>
</span><span id="__span-3-34"><a id="__codelineno-3-34" name="__codelineno-3-34" href="#__codelineno-3-34"></a><span class="c1"># Run several cluster updates</span>
</span><span id="__span-3-35"><a id="__codelineno-3-35" name="__codelineno-3-35" href="#__codelineno-3-35"></a><span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">200</span><span class="p">):</span>
</span><span id="__span-3-36"><a id="__codelineno-3-36" name="__codelineno-3-36" href="#__codelineno-3-36"></a>    <span class="n">spins</span> <span class="o">=</span> <span class="n">wolff_step</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">p_add</span><span class="p">)</span>
</span><span id="__span-3-37"><a id="__codelineno-3-37" name="__codelineno-3-37" href="#__codelineno-3-37"></a>
</span><span id="__span-3-38"><a id="__codelineno-3-38" name="__codelineno-3-38" href="#__codelineno-3-38"></a><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">spins</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;coolwarm&quot;</span><span class="p">)</span>
</span><span id="__span-3-39"><a id="__codelineno-3-39" name="__codelineno-3-39" href="#__codelineno-3-39"></a><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;2D Ising configuration after Wolff updates&quot;</span><span class="p">)</span>
</span><span id="__span-3-40"><a id="__codelineno-3-40" name="__codelineno-3-40" href="#__codelineno-3-40"></a><span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
</span><span id="__span-3-41"><a id="__codelineno-3-41" name="__codelineno-3-41" href="#__codelineno-3-41"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></code></pre></div>
<p>You’ll see the lattice reorganize quickly — the entire configuration decorrelates in a few updates instead of thousands of single-spin flips.</p>
<hr />
<h3 id="mathematical-insight-why-it-works"><strong>Mathematical Insight: Why It Works</strong></h3>
<p>The Wolff update satisfies <strong>detailed balance</strong> because the probability of forming a specific cluster and flipping it is symmetric between the old and new configurations.</p>
<div class="admonition example">
<p class="admonition-title">Cluster Size Near the Critical Point</p>
<p>In the 2D Ising model at <span class="arithmatex">\(T_c \approx 2.269J/k_B\)</span>, clusters grow dramatically:</p>
<ul>
<li><strong>Below <span class="arithmatex">\(T_c\)</span></strong>: Small clusters (typical size <span class="arithmatex">\(\sim 10\)</span> spins) because domains are stable</li>
<li><strong>At <span class="arithmatex">\(T_c\)</span></strong>: Fractal clusters spanning the system (size <span class="arithmatex">\(\sim L^{d_f}\)</span> with <span class="arithmatex">\(d_f \approx 1.9\)</span>)</li>
<li><strong>Above <span class="arithmatex">\(T_c\)</span></strong>: Small clusters again (disordered phase)</li>
</ul>
<p>The Wolff algorithm's power comes from flipping these large critical clusters in one move, sidestepping the correlation time divergence <span class="arithmatex">\(\tau \sim \xi^2\)</span> that plagues Metropolis. Cluster autocorrelation times remain <span class="arithmatex">\(\mathcal{O}(1)\)</span> even at <span class="arithmatex">\(T_c\)</span>.</p>
</div>
<p>Cluster addition mimics correlated fluctuations:
$$
P(\text{bond}) = 1 - e^{-2\beta J},
$$
ensuring that connected aligned spins tend to flip together.</p>
<p>As a result, the autocorrelation time <span class="arithmatex">\(\tau\)</span> scales as
$$
\tau \sim L^z,
$$
with a dynamic exponent <span class="arithmatex">\(z \approx 0\)</span>–1, much smaller than <span class="arithmatex">\(z \approx 2\)</span> for single-spin Metropolis updates — hence the dramatic speed-up.</p>
<hr />
<h3 id="comparison-with-metropolis"><strong>Comparison with Metropolis</strong></h3>
<table>
<thead>
<tr>
<th style="text-align: left;">Property</th>
<th style="text-align: left;">Metropolis</th>
<th style="text-align: left;">Wolff Cluster</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">Move type</td>
<td style="text-align: left;">Single spin</td>
<td style="text-align: left;">Whole correlated cluster</td>
</tr>
<tr>
<td style="text-align: left;">Correlation time (<span class="arithmatex">\(\tau\)</span>)</td>
<td style="text-align: left;">Large near <span class="arithmatex">\(T_c\)</span></td>
<td style="text-align: left;">Small (<span class="arithmatex">\(\tau\)</span> ≈ const)</td>
</tr>
<tr>
<td style="text-align: left;">Acceptance rate</td>
<td style="text-align: left;">Variable</td>
<td style="text-align: left;">Always 1</td>
</tr>
<tr>
<td style="text-align: left;">Complexity</td>
<td style="text-align: left;">Simpler</td>
<td style="text-align: left;">Slightly higher per step</td>
</tr>
<tr>
<td style="text-align: left;">Efficiency near <span class="arithmatex">\(T_c\)</span></td>
<td style="text-align: left;">Poor</td>
<td style="text-align: left;">Excellent</td>
</tr>
<tr>
<td style="text-align: left;">-----</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<h3 id="summary_1"><strong>Summary</strong></h3>
<ul>
<li><strong>Cluster algorithms</strong> overcome critical slowing down by flipping correlated domains.</li>
<li>The <strong>Wolff</strong> method constructs clusters probabilistically, preserving detailed balance.</li>
<li>At the critical point, cluster updates drastically reduce correlation times.</li>
<li>This technique is now a standard in Monte Carlo studies of phase transitions.</li>
</ul>
<hr />
<h2 id="63-parallel-tempering-escaping-local-minima"><strong>6.3 Parallel Tempering (Escaping Local Minima)</strong></h2>
<hr />
<h3 id="motivation-the-trap-of-rugged-landscapes"><strong>Motivation: The Trap of Rugged Landscapes</strong></h3>
<p>Some energy landscapes are so rough that no amount of clever local moves can easily traverse them.
Even cluster updates may fail when the system is trapped in deep local minima separated by high barriers.</p>
<p>Imagine a mountain range again — but now, it’s covered in fog, and the valleys are separated by massive cliffs.
At low temperatures, a system behaves like a hiker unwilling to climb uphill.</p>
<p>So how do we help it <em>escape</em>?</p>
<p>The idea of <strong>Parallel Tempering (Replica Exchange Monte Carlo)</strong> is beautifully simple:</p>
<blockquote>
<p>Run multiple replicas of the system at different temperatures — and let them swap configurations.</p>
</blockquote>
<p><strong>Pseudo-code: Parallel Tempering Framework</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>Algorithm: Parallel_Tempering(n_replicas, beta_ladder, n_steps)
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>  Input: number of replicas, temperature ladder [β₁, β₂, ..., βₙ], simulation steps
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>  Output: equilibrated configurations at each temperature
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a>  1. Initialize n_replicas configurations X₁, X₂, ..., Xₙ
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a>  2. for step = 1 to n_steps:
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a>       // Monte Carlo updates for each replica
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a>       for i = 1 to n_replicas:
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a>         update Xᵢ using Metropolis/Cluster at temperature βᵢ
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a>
</span><span id="__span-4-11"><a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a>       // Attempt replica swaps (even-odd scheme)
</span><span id="__span-4-12"><a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a>       if step is even:
</span><span id="__span-4-13"><a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a>         pairs ← [(1,2), (3,4), (5,6), ...]
</span><span id="__span-4-14"><a id="__codelineno-4-14" name="__codelineno-4-14" href="#__codelineno-4-14"></a>       else:
</span><span id="__span-4-15"><a id="__codelineno-4-15" name="__codelineno-4-15" href="#__codelineno-4-15"></a>         pairs ← [(2,3), (4,5), (6,7), ...]
</span><span id="__span-4-16"><a id="__codelineno-4-16" name="__codelineno-4-16" href="#__codelineno-4-16"></a>
</span><span id="__span-4-17"><a id="__codelineno-4-17" name="__codelineno-4-17" href="#__codelineno-4-17"></a>       for each pair (i, j) in pairs:
</span><span id="__span-4-18"><a id="__codelineno-4-18" name="__codelineno-4-18" href="#__codelineno-4-18"></a>         ΔE ← E(Xᵢ) - E(Xⱼ)
</span><span id="__span-4-19"><a id="__codelineno-4-19" name="__codelineno-4-19" href="#__codelineno-4-19"></a>         Δβ ← βⱼ - βᵢ
</span><span id="__span-4-20"><a id="__codelineno-4-20" name="__codelineno-4-20" href="#__codelineno-4-20"></a>         if random() &lt; exp(ΔE × Δβ):
</span><span id="__span-4-21"><a id="__codelineno-4-21" name="__codelineno-4-21" href="#__codelineno-4-21"></a>           swap Xᵢ and Xⱼ
</span><span id="__span-4-22"><a id="__codelineno-4-22" name="__codelineno-4-22" href="#__codelineno-4-22"></a>
</span><span id="__span-4-23"><a id="__codelineno-4-23" name="__codelineno-4-23" href="#__codelineno-4-23"></a>  3. return {X₁, X₂, ..., Xₙ}
</span></code></pre></div>
<hr />
<h3 id="the-core-idea"><strong>The Core Idea</strong></h3>
<p>Each replica <span class="arithmatex">\(i\)</span> samples from the Boltzmann distribution at temperature <span class="arithmatex">\(T_i\)</span>, with inverse temperature <span class="arithmatex">\(\beta_i = 1/(k_B T_i)\)</span>:</p>
<div class="arithmatex">\[
P_i(X) \propto e^{-\beta_i E(X)}.
\]</div>
<p>Occasionally, we attempt to <strong>swap</strong> configurations between replicas <span class="arithmatex">\(i\)</span> and <span class="arithmatex">\(j\)</span>.
This swap is accepted with probability</p>
<div class="arithmatex">\[
P_{\text{swap}} = \min!\left(1, e^{(\beta_i - \beta_j)(E_j - E_i)}\right).
\]</div>
<p>This preserves detailed balance <em>across</em> all replicas — so the joint ensemble remains at equilibrium.</p>
<p>High-<span class="arithmatex">\(T\)</span> replicas (hot) explore freely; low-<span class="arithmatex">\(T\)</span> replicas (cold) collect precise statistics.
By swapping, the cold replicas can "borrow" the mobility of hot ones to escape local minima.</p>
<hr />
<h3 id="conceptual-picture"><strong>Conceptual Picture</strong></h3>
<table>
<thead>
<tr>
<th style="text-align: left;">Replica</th>
<th style="text-align: left;">Temperature</th>
<th style="text-align: left;">Behavior</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">1</td>
<td style="text-align: left;">Low (<span class="arithmatex">\(T_1\)</span>)</td>
<td style="text-align: left;">Precise but easily trapped</td>
</tr>
<tr>
<td style="text-align: left;">2</td>
<td style="text-align: left;">Medium (<span class="arithmatex">\(T_2\)</span>)</td>
<td style="text-align: left;">Moderate exploration</td>
</tr>
<tr>
<td style="text-align: left;">3</td>
<td style="text-align: left;">High (<span class="arithmatex">\(T_3\)</span>)</td>
<td style="text-align: left;">Moves freely across barriers</td>
</tr>
</tbody>
</table>
<p>High-temperature replicas smooth out the landscape; low-temperature replicas refine the details.
The swapping allows energy information to percolate between them.</p>
<hr />
<h3 id="implementation-example-1d-double-well-system"><strong>Implementation Example (1D Double-Well System)</strong></h3>
<p>We’ll demonstrate parallel tempering using our earlier double-well potential.</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="c1"># Define potential</span>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="k">def</span><span class="w"> </span><span class="nf">E</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a>    <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span>
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a>
</span><span id="__span-5-8"><a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a><span class="k">def</span><span class="w"> </span><span class="nf">metropolis_step</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">step_size</span><span class="o">=</span><span class="mf">0.5</span><span class="p">):</span>
</span><span id="__span-5-9"><a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a>    <span class="n">x_trial</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="n">step_size</span><span class="p">,</span> <span class="n">step_size</span><span class="p">)</span>
</span><span id="__span-5-10"><a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a>    <span class="n">dE</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="n">x_trial</span><span class="p">)</span> <span class="o">-</span> <span class="n">E</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</span><span id="__span-5-11"><a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a>    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">beta</span> <span class="o">*</span> <span class="n">dE</span><span class="p">):</span>
</span><span id="__span-5-12"><a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a>        <span class="k">return</span> <span class="n">x_trial</span>
</span><span id="__span-5-13"><a id="__codelineno-5-13" name="__codelineno-5-13" href="#__codelineno-5-13"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-5-14"><a id="__codelineno-5-14" name="__codelineno-5-14" href="#__codelineno-5-14"></a>        <span class="k">return</span> <span class="n">x</span>
</span><span id="__span-5-15"><a id="__codelineno-5-15" name="__codelineno-5-15" href="#__codelineno-5-15"></a>
</span><span id="__span-5-16"><a id="__codelineno-5-16" name="__codelineno-5-16" href="#__codelineno-5-16"></a><span class="c1"># Initialize replicas at different temperatures</span>
</span><span id="__span-5-17"><a id="__codelineno-5-17" name="__codelineno-5-17" href="#__codelineno-5-17"></a><span class="n">betas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">])</span>
</span><span id="__span-5-18"><a id="__codelineno-5-18" name="__codelineno-5-18" href="#__codelineno-5-18"></a><span class="n">n_replicas</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">betas</span><span class="p">)</span>
</span><span id="__span-5-19"><a id="__codelineno-5-19" name="__codelineno-5-19" href="#__codelineno-5-19"></a><span class="n">steps</span> <span class="o">=</span> <span class="mi">20000</span>
</span><span id="__span-5-20"><a id="__codelineno-5-20" name="__codelineno-5-20" href="#__codelineno-5-20"></a>
</span><span id="__span-5-21"><a id="__codelineno-5-21" name="__codelineno-5-21" href="#__codelineno-5-21"></a><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">n_replicas</span><span class="p">,</span> <span class="n">steps</span><span class="p">))</span>
</span><span id="__span-5-22"><a id="__codelineno-5-22" name="__codelineno-5-22" href="#__codelineno-5-22"></a><span class="n">x_init</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">n_replicas</span><span class="p">)</span>
</span><span id="__span-5-23"><a id="__codelineno-5-23" name="__codelineno-5-23" href="#__codelineno-5-23"></a>
</span><span id="__span-5-24"><a id="__codelineno-5-24" name="__codelineno-5-24" href="#__codelineno-5-24"></a><span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">steps</span><span class="p">):</span>
</span><span id="__span-5-25"><a id="__codelineno-5-25" name="__codelineno-5-25" href="#__codelineno-5-25"></a>    <span class="c1"># Metropolis updates for each replica</span>
</span><span id="__span-5-26"><a id="__codelineno-5-26" name="__codelineno-5-26" href="#__codelineno-5-26"></a>    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">beta</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">betas</span><span class="p">):</span>
</span><span id="__span-5-27"><a id="__codelineno-5-27" name="__codelineno-5-27" href="#__codelineno-5-27"></a>        <span class="n">x_init</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">metropolis_step</span><span class="p">(</span><span class="n">x_init</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">beta</span><span class="p">)</span>
</span><span id="__span-5-28"><a id="__codelineno-5-28" name="__codelineno-5-28" href="#__codelineno-5-28"></a>
</span><span id="__span-5-29"><a id="__codelineno-5-29" name="__codelineno-5-29" href="#__codelineno-5-29"></a>    <span class="c1"># Attempt swaps between neighboring replicas</span>
</span><span id="__span-5-30"><a id="__codelineno-5-30" name="__codelineno-5-30" href="#__codelineno-5-30"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_replicas</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="__span-5-31"><a id="__codelineno-5-31" name="__codelineno-5-31" href="#__codelineno-5-31"></a>        <span class="n">d_beta</span> <span class="o">=</span> <span class="n">betas</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">betas</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="__span-5-32"><a id="__codelineno-5-32" name="__codelineno-5-32" href="#__codelineno-5-32"></a>        <span class="n">dE</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="n">x_init</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span> <span class="o">-</span> <span class="n">E</span><span class="p">(</span><span class="n">x_init</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="__span-5-33"><a id="__codelineno-5-33" name="__codelineno-5-33" href="#__codelineno-5-33"></a>        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">d_beta</span> <span class="o">*</span> <span class="n">dE</span><span class="p">):</span>
</span><span id="__span-5-34"><a id="__codelineno-5-34" name="__codelineno-5-34" href="#__codelineno-5-34"></a>            <span class="n">x_init</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">x_init</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">x_init</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">x_init</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
</span><span id="__span-5-35"><a id="__codelineno-5-35" name="__codelineno-5-35" href="#__codelineno-5-35"></a>
</span><span id="__span-5-36"><a id="__codelineno-5-36" name="__codelineno-5-36" href="#__codelineno-5-36"></a>    <span class="n">X</span><span class="p">[:,</span> <span class="n">t</span><span class="p">]</span> <span class="o">=</span> <span class="n">x_init</span>
</span></code></pre></div>
<p>Let’s visualize the evolution of one low-temperature replica:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="p">:],</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Trajectory of Low-Temperature Replica in Parallel Tempering&quot;</span><span class="p">)</span>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Step&quot;</span><span class="p">)</span>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;$x$&quot;</span><span class="p">)</span>
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a><span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></code></pre></div>
<p>You’ll see that the cold replica (β=5) now <strong>jumps between wells</strong> thanks to swaps — something it could not do alone.</p>
<hr />
<h3 id="why-it-works"><strong>Why It Works</strong></h3>
<p>Parallel tempering works because it <strong>couples energy fluctuations at different temperatures</strong>.
Hot replicas explore widely, discovering new basins of attraction.
Swapping these configurations downward allows cold replicas to sample globally while maintaining local accuracy.</p>
<p>Formally, detailed balance is preserved since</p>
<div class="arithmatex">\[
P_{\text{eq}}(X_i, X_j) \propto e^{-\beta_i E(X_i)} e^{-\beta_j E(X_j)}
\]</div>
<p>and the swap acceptance rule ensures symmetry under <span class="arithmatex">\((i \leftrightarrow j)\)</span>.</p>
<details class="question">
<summary>How Do You Choose the Temperature Ladder?</summary>
<p>The temperature ladder design is critical for efficient replica exchange. Key principles:</p>
<ol>
<li><strong>Overlap criterion</strong>: Adjacent replicas' energy distributions should overlap significantly (typically 20-40% acceptance rate for swaps)</li>
<li><strong>Geometric spacing</strong>: <span class="arithmatex">\(T_{i+1}/T_i \approx\)</span> constant works well for many systems</li>
<li><strong>Rule of thumb</strong>: For system with heat capacity <span class="arithmatex">\(C_V\)</span>, spacing <span class="arithmatex">\(\Delta \beta \approx 1/\sqrt{C_V}\)</span></li>
</ol>
<p><strong>Example</strong>: For a 100-spin Ising model near <span class="arithmatex">\(T_c\)</span>, use 8-12 replicas spanning <span class="arithmatex">\(0.8T_c\)</span> to <span class="arithmatex">\(2T_c\)</span>. Too few replicas → poor acceptance; too many → wasted computation. Monitor swap rates and adjust!</p>
</details>
<hr />
<h3 id="tuning-and-practical-notes"><strong>Tuning and Practical Notes</strong></h3>
<ul>
<li>The <strong>temperature ladder</strong> should be chosen so that neighboring replicas’ energy distributions overlap.
  Typically geometric spacing works well:
  $$
  T_{i+1} = T_i , r \quad \text{with } r \approx 1.1{-}1.3.
  $$</li>
<li>Swap attempts are made every few local updates.</li>
<li>Good practice: monitor the <strong>swap acceptance rate</strong> (ideal range ≈ 20–50%).</li>
</ul>
<hr />
<h3 id="comparison-with-other-methods"><strong>Comparison with Other Methods</strong></h3>
<table>
<thead>
<tr>
<th style="text-align: left;">Feature</th>
<th style="text-align: left;">Metropolis</th>
<th style="text-align: left;">Cluster</th>
<th style="text-align: left;">Parallel Tempering</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">Locality</td>
<td style="text-align: left;">Local</td>
<td style="text-align: left;">Correlated domain</td>
<td style="text-align: left;">Multiple replicas</td>
</tr>
<tr>
<td style="text-align: left;">Escapes barriers?</td>
<td style="text-align: left;">Rarely</td>
<td style="text-align: left;">Partially</td>
<td style="text-align: left;">Efficiently</td>
</tr>
<tr>
<td style="text-align: left;">Best for</td>
<td style="text-align: left;">Simple energy landscapes</td>
<td style="text-align: left;">Critical slowing down</td>
<td style="text-align: left;">Rugged, multi-minima systems</td>
</tr>
<tr>
<td style="text-align: left;">Typical use</td>
<td style="text-align: left;">General MC</td>
<td style="text-align: left;">Spin systems</td>
<td style="text-align: left;">Glassy / biomolecular systems</td>
</tr>
</tbody>
</table>
<hr />
<h3 id="summary_2"><strong>Summary</strong></h3>
<ul>
<li><strong>Parallel Tempering</strong> runs multiple replicas at different temperatures and swaps their configurations.</li>
<li>It combines the <strong>exploration power</strong> of high <span class="arithmatex">\(T\)</span> with the <strong>accuracy</strong> of low <span class="arithmatex">\(T\)</span>.</li>
<li>The method maintains detailed balance and works on highly rugged landscapes.</li>
<li>It's widely used in <strong>spin glasses</strong>, <strong>protein folding</strong>, and <strong>Bayesian sampling</strong>.</li>
</ul>
<hr />
<h2 id="64-the-wanglandau-algorithm-sampling-the-density-of-states"><strong>6.4 The Wang–Landau Algorithm (Sampling the Density of States)</strong></h2>
<hr />
<h3 id="motivation-beyond-temperature-dependent-sampling"><strong>Motivation: Beyond Temperature-Dependent Sampling</strong></h3>
<p>Monte Carlo methods like Metropolis and even Parallel Tempering depend on a <em>temperature parameter</em> <span class="arithmatex">\(T\)</span> (or <span class="arithmatex">\(\beta = 1/(k_B T)\)</span>).
But what if we want to know <strong>thermodynamic properties for all temperatures at once</strong>?</p>
<p>Enter the <strong>Wang–Landau algorithm</strong>, a remarkable method that directly estimates the <strong>density of states</strong>, <span class="arithmatex">\(g(E)\)</span>.</p>
<p>The density of states tells us how many configurations exist at a given energy <span class="arithmatex">\(E\)</span> —
and once we know <span class="arithmatex">\(g(E)\)</span>, we can compute <em>everything</em>:</p>
<div class="arithmatex">\[
Z(\beta) = \sum_E g(E) e^{-\beta E}, \quad
\langle E \rangle = \frac{\sum_E E g(E) e^{-\beta E}}{Z(\beta)}, \quad
F(\beta) = -k_B T \ln Z.
\]</div>
<p>So rather than simulating at fixed <span class="arithmatex">\(T\)</span>, Wang–Landau <em>learns the landscape itself</em> — an approach that’s both elegant and powerful.</p>
<hr />
<h3 id="the-core-idea_1"><strong>The Core Idea</strong></h3>
<p>Instead of sampling configurations with probability <span class="arithmatex">\(\propto e^{-\beta E}\)</span>, we aim for a <strong>flat histogram</strong> in energy space:
each energy level should be visited equally often.</p>
<p>We achieve this by <strong>iteratively refining</strong> an estimate of <span class="arithmatex">\(g(E)\)</span> during simulation.</p>
<p>Algorithm sketch:</p>
<ol>
<li>Initialize <span class="arithmatex">\(g(E) = 1\)</span> for all <span class="arithmatex">\(E\)</span> and a modification factor <span class="arithmatex">\(f = e^1\)</span>.</li>
<li>Start from some configuration with energy <span class="arithmatex">\(E\)</span>.</li>
<li>Propose a move <span class="arithmatex">\(E \rightarrow E'\)</span>.
   Accept it with probability
   $$
   P_{\text{accept}} = \min!\left(1, \frac{g(E)}{g(E')}\right).
   $$</li>
<li>Update the histogram: <span class="arithmatex">\(H(E') \leftarrow H(E') + 1\)</span>.</li>
<li>Update the estimate: <span class="arithmatex">\(g(E') \leftarrow g(E') \times f\)</span>.</li>
<li>When the histogram <span class="arithmatex">\(H(E)\)</span> is “flat,” reset it and reduce <span class="arithmatex">\(f \to \sqrt{f}\)</span>.</li>
<li>Repeat until <span class="arithmatex">\(f\)</span> is sufficiently close to 1 (e.g., <span class="arithmatex">\(f &lt; e^{10^{-8}}\)</span>).</li>
</ol>
<p>By the end, <span class="arithmatex">\(g(E)\)</span> converges (up to a multiplicative constant) to the true density of states.</p>
<hr />
<h3 id="mathematical-perspective"><strong>Mathematical Perspective</strong></h3>
<p>The algorithm performs a <strong>non-Markovian random walk in energy space</strong>.
Its stationary distribution is proportional to <span class="arithmatex">\(1/g(E)\)</span>,
so the histogram <span class="arithmatex">\(H(E)\)</span> approaches a uniform distribution once <span class="arithmatex">\(g(E)\)</span> approximates the true density of states.</p>
<p>The modification factor <span class="arithmatex">\(f\)</span> controls learning rate — initially large for exploration,
then gradually reduced to refine accuracy.</p>
<hr />
<h3 id="implementation-example-1d-double-well-system_1"><strong>Implementation Example: 1D Double-Well System</strong></h3>
<p>We'll demonstrate Wang–Landau sampling on our familiar double-well potential.</p>
<p><strong>Pseudo-code: Wang-Landau Flat Histogram Sampling</strong></p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>Algorithm: Wang_Landau(energy_bins, convergence_threshold)
</span><span id="__span-7-2"><a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>  Input: discretized energy bins, flatness criterion (e.g., 0.95)
</span><span id="__span-7-3"><a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>  Output: estimated density of states g(E)
</span><span id="__span-7-4"><a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a>
</span><span id="__span-7-5"><a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a>  1. Initialize g(E) ← 1 for all energy bins
</span><span id="__span-7-6"><a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a>  2. Initialize histogram H(E) ← 0
</span><span id="__span-7-7"><a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a>  3. modification_factor f ← e ≈ 2.718
</span><span id="__span-7-8"><a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a>
</span><span id="__span-7-9"><a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a>  4. while f &gt; convergence_threshold:
</span><span id="__span-7-10"><a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a>       // Sampling phase
</span><span id="__span-7-11"><a id="__codelineno-7-11" name="__codelineno-7-11" href="#__codelineno-7-11"></a>       for step = 1 to n_sampling_steps:
</span><span id="__span-7-12"><a id="__codelineno-7-12" name="__codelineno-7-12" href="#__codelineno-7-12"></a>         propose new configuration X&#39;
</span><span id="__span-7-13"><a id="__codelineno-7-13" name="__codelineno-7-13" href="#__codelineno-7-13"></a>         ΔE ← E(X&#39;) - E(X)
</span><span id="__span-7-14"><a id="__codelineno-7-14" name="__codelineno-7-14" href="#__codelineno-7-14"></a>         acceptance ← min(1, g(E_old) / g(E_new))
</span><span id="__span-7-15"><a id="__codelineno-7-15" name="__codelineno-7-15" href="#__codelineno-7-15"></a>
</span><span id="__span-7-16"><a id="__codelineno-7-16" name="__codelineno-7-16" href="#__codelineno-7-16"></a>         if random() &lt; acceptance:
</span><span id="__span-7-17"><a id="__codelineno-7-17" name="__codelineno-7-17" href="#__codelineno-7-17"></a>           X ← X&#39;
</span><span id="__span-7-18"><a id="__codelineno-7-18" name="__codelineno-7-18" href="#__codelineno-7-18"></a>           current_energy ← E_new
</span><span id="__span-7-19"><a id="__codelineno-7-19" name="__codelineno-7-19" href="#__codelineno-7-19"></a>
</span><span id="__span-7-20"><a id="__codelineno-7-20" name="__codelineno-7-20" href="#__codelineno-7-20"></a>         update g(current_energy) ← g(current_energy) × f
</span><span id="__span-7-21"><a id="__codelineno-7-21" name="__codelineno-7-21" href="#__codelineno-7-21"></a>         update H(current_energy) ← H(current_energy) + 1
</span><span id="__span-7-22"><a id="__codelineno-7-22" name="__codelineno-7-22" href="#__codelineno-7-22"></a>
</span><span id="__span-7-23"><a id="__codelineno-7-23" name="__codelineno-7-23" href="#__codelineno-7-23"></a>       // Check flatness
</span><span id="__span-7-24"><a id="__codelineno-7-24" name="__codelineno-7-24" href="#__codelineno-7-24"></a>       if H is &quot;flat&quot; (all bins within 95% of mean):
</span><span id="__span-7-25"><a id="__codelineno-7-25" name="__codelineno-7-25" href="#__codelineno-7-25"></a>         f ← sqrt(f)  // reduce modification factor
</span><span id="__span-7-26"><a id="__codelineno-7-26" name="__codelineno-7-26" href="#__codelineno-7-26"></a>         reset H ← 0
</span><span id="__span-7-27"><a id="__codelineno-7-27" name="__codelineno-7-27" href="#__codelineno-7-27"></a>
</span><span id="__span-7-28"><a id="__codelineno-7-28" name="__codelineno-7-28" href="#__codelineno-7-28"></a>  5. return g(E)  // density of states
</span></code></pre></div>
<p><strong>Python Implementation:</strong></p>
<h2 id="import-numpy-as-np-import-matplotlibpyplot-as-plt-def-ex-return-x4-2x2-discretize-energy-range-e_bins-nplinspace-15-20-100-g-npones_likee_bins-initial-guess-h-npzeros_likee_bins-f-npe-modification-factor-x-00-def-find_bine_val-return-npargminnpabse_bins-e_val-flatness_threshold-08-max_iter-1000000-for-step-in-rangemax_iter-propose-a-move-x_trial-x-nprandomuniform-05-05-ei-ej-ex-ex_trial-bi-bj-find_binei-find_binej-acceptance-rule-using-ge-if-nprandomrand-min1-gbigbj-x-x_trial-b-bj-else-b-bi-update-ge-and-histogram-gb-f-hb-1-periodic-check-for-flatness-if-step-5000-0-and-npminh-flatness_threshold-npmeanh-f-npsqrtf-h-0-if-f-npexp1e-8-break"><div class="language-python highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="k">def</span><span class="w"> </span><span class="nf">E</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a>    <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span>
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a>
</span><span id="__span-8-7"><a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a><span class="c1"># Discretize energy range</span>
</span><span id="__span-8-8"><a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a><span class="n">E_bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
</span><span id="__span-8-9"><a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a><span class="n">g</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">E_bins</span><span class="p">)</span>  <span class="c1"># initial guess</span>
</span><span id="__span-8-10"><a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a><span class="n">H</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">E_bins</span><span class="p">)</span>
</span><span id="__span-8-11"><a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a><span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">e</span>  <span class="c1"># modification factor</span>
</span><span id="__span-8-12"><a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a><span class="n">x</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="__span-8-13"><a id="__codelineno-8-13" name="__codelineno-8-13" href="#__codelineno-8-13"></a>
</span><span id="__span-8-14"><a id="__codelineno-8-14" name="__codelineno-8-14" href="#__codelineno-8-14"></a><span class="k">def</span><span class="w"> </span><span class="nf">find_bin</span><span class="p">(</span><span class="n">E_val</span><span class="p">):</span>
</span><span id="__span-8-15"><a id="__codelineno-8-15" name="__codelineno-8-15" href="#__codelineno-8-15"></a>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">E_bins</span> <span class="o">-</span> <span class="n">E_val</span><span class="p">))</span>
</span><span id="__span-8-16"><a id="__codelineno-8-16" name="__codelineno-8-16" href="#__codelineno-8-16"></a>
</span><span id="__span-8-17"><a id="__codelineno-8-17" name="__codelineno-8-17" href="#__codelineno-8-17"></a><span class="n">flatness_threshold</span> <span class="o">=</span> <span class="mf">0.8</span>
</span><span id="__span-8-18"><a id="__codelineno-8-18" name="__codelineno-8-18" href="#__codelineno-8-18"></a><span class="n">max_iter</span> <span class="o">=</span> <span class="mi">1000000</span>
</span><span id="__span-8-19"><a id="__codelineno-8-19" name="__codelineno-8-19" href="#__codelineno-8-19"></a>
</span><span id="__span-8-20"><a id="__codelineno-8-20" name="__codelineno-8-20" href="#__codelineno-8-20"></a><span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">max_iter</span><span class="p">):</span>
</span><span id="__span-8-21"><a id="__codelineno-8-21" name="__codelineno-8-21" href="#__codelineno-8-21"></a>    <span class="c1"># Propose a move</span>
</span><span id="__span-8-22"><a id="__codelineno-8-22" name="__codelineno-8-22" href="#__codelineno-8-22"></a>    <span class="n">x_trial</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
</span><span id="__span-8-23"><a id="__codelineno-8-23" name="__codelineno-8-23" href="#__codelineno-8-23"></a>    <span class="n">Ei</span><span class="p">,</span> <span class="n">Ej</span> <span class="o">=</span> <span class="n">E</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">E</span><span class="p">(</span><span class="n">x_trial</span><span class="p">)</span>
</span><span id="__span-8-24"><a id="__codelineno-8-24" name="__codelineno-8-24" href="#__codelineno-8-24"></a>    <span class="n">bi</span><span class="p">,</span> <span class="n">bj</span> <span class="o">=</span> <span class="n">find_bin</span><span class="p">(</span><span class="n">Ei</span><span class="p">),</span> <span class="n">find_bin</span><span class="p">(</span><span class="n">Ej</span><span class="p">)</span>
</span><span id="__span-8-25"><a id="__codelineno-8-25" name="__codelineno-8-25" href="#__codelineno-8-25"></a>
</span><span id="__span-8-26"><a id="__codelineno-8-26" name="__codelineno-8-26" href="#__codelineno-8-26"></a>    <span class="c1"># Acceptance rule using g(E)</span>
</span><span id="__span-8-27"><a id="__codelineno-8-27" name="__codelineno-8-27" href="#__codelineno-8-27"></a>    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span> <span class="o">&lt;</span> <span class="nb">min</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">g</span><span class="p">[</span><span class="n">bi</span><span class="p">]</span><span class="o">/</span><span class="n">g</span><span class="p">[</span><span class="n">bj</span><span class="p">]):</span>
</span><span id="__span-8-28"><a id="__codelineno-8-28" name="__codelineno-8-28" href="#__codelineno-8-28"></a>        <span class="n">x</span> <span class="o">=</span> <span class="n">x_trial</span>
</span><span id="__span-8-29"><a id="__codelineno-8-29" name="__codelineno-8-29" href="#__codelineno-8-29"></a>        <span class="n">b</span> <span class="o">=</span> <span class="n">bj</span>
</span><span id="__span-8-30"><a id="__codelineno-8-30" name="__codelineno-8-30" href="#__codelineno-8-30"></a>    <span class="k">else</span><span class="p">:</span>
</span><span id="__span-8-31"><a id="__codelineno-8-31" name="__codelineno-8-31" href="#__codelineno-8-31"></a>        <span class="n">b</span> <span class="o">=</span> <span class="n">bi</span>
</span><span id="__span-8-32"><a id="__codelineno-8-32" name="__codelineno-8-32" href="#__codelineno-8-32"></a>
</span><span id="__span-8-33"><a id="__codelineno-8-33" name="__codelineno-8-33" href="#__codelineno-8-33"></a>    <span class="c1"># Update g(E) and histogram</span>
</span><span id="__span-8-34"><a id="__codelineno-8-34" name="__codelineno-8-34" href="#__codelineno-8-34"></a>    <span class="n">g</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">*=</span> <span class="n">f</span>
</span><span id="__span-8-35"><a id="__codelineno-8-35" name="__codelineno-8-35" href="#__codelineno-8-35"></a>    <span class="n">H</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="__span-8-36"><a id="__codelineno-8-36" name="__codelineno-8-36" href="#__codelineno-8-36"></a>
</span><span id="__span-8-37"><a id="__codelineno-8-37" name="__codelineno-8-37" href="#__codelineno-8-37"></a>    <span class="c1"># Periodic check for flatness</span>
</span><span id="__span-8-38"><a id="__codelineno-8-38" name="__codelineno-8-38" href="#__codelineno-8-38"></a>    <span class="k">if</span> <span class="n">step</span> <span class="o">%</span> <span class="mi">5000</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">H</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">flatness_threshold</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">H</span><span class="p">):</span>
</span><span id="__span-8-39"><a id="__codelineno-8-39" name="__codelineno-8-39" href="#__codelineno-8-39"></a>        <span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span><span id="__span-8-40"><a id="__codelineno-8-40" name="__codelineno-8-40" href="#__codelineno-8-40"></a>        <span class="n">H</span><span class="p">[:]</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="__span-8-41"><a id="__codelineno-8-41" name="__codelineno-8-41" href="#__codelineno-8-41"></a>        <span class="k">if</span> <span class="n">f</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mf">1e-8</span><span class="p">):</span>
</span><span id="__span-8-42"><a id="__codelineno-8-42" name="__codelineno-8-42" href="#__codelineno-8-42"></a>            <span class="k">break</span>
</span></code></pre></div></h2>
<h3 id="visualization-of-convergence"><strong>Visualization of Convergence</strong></h3>
<div class="language-python highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">E_bins</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">g</span><span class="p">),</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;$E$&quot;</span><span class="p">)</span>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;$</span><span class="se">\\</span><span class="s2">log g(E)$&quot;</span><span class="p">)</span>
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Estimated Density of States via Wang–Landau Sampling&quot;</span><span class="p">)</span>
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a><span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-9-7"><a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></code></pre></div>
<p>You’ll see <span class="arithmatex">\(\log g(E)\)</span> approaching a smooth curve that reflects the system’s energy distribution.
Regions with many accessible configurations have higher <span class="arithmatex">\(g(E)\)</span>.</p>
<hr />
<h3 id="recovering-thermodynamic-quantities"><strong>Recovering Thermodynamic Quantities</strong></h3>
<p>Once <span class="arithmatex">\(g(E)\)</span> is known, we can compute the partition function and related observables for any temperature <span class="arithmatex">\(T\)</span>:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">thermodynamic_averages</span><span class="p">(</span><span class="n">beta</span><span class="p">,</span> <span class="n">E_bins</span><span class="p">,</span> <span class="n">g</span><span class="p">):</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>    <span class="n">Z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">g</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">beta</span> <span class="o">*</span> <span class="n">E_bins</span><span class="p">))</span>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a>    <span class="n">avgE</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">E_bins</span> <span class="o">*</span> <span class="n">g</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">beta</span> <span class="o">*</span> <span class="n">E_bins</span><span class="p">))</span> <span class="o">/</span> <span class="n">Z</span>
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a>    <span class="n">Cv</span> <span class="o">=</span> <span class="n">beta</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">E_bins</span> <span class="o">-</span> <span class="n">avgE</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">g</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">beta</span> <span class="o">*</span> <span class="n">E_bins</span><span class="p">))</span> <span class="o">/</span> <span class="n">Z</span>
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a>    <span class="k">return</span> <span class="n">avgE</span><span class="p">,</span> <span class="n">Cv</span>
</span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a>
</span><span id="__span-10-7"><a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a><span class="n">betas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
</span><span id="__span-10-8"><a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a><span class="n">E_avg</span><span class="p">,</span> <span class="n">Cv</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
</span><span id="__span-10-9"><a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a>
</span><span id="__span-10-10"><a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a><span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">betas</span><span class="p">:</span>
</span><span id="__span-10-11"><a id="__codelineno-10-11" name="__codelineno-10-11" href="#__codelineno-10-11"></a>    <span class="n">e</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">thermodynamic_averages</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">E_bins</span><span class="p">,</span> <span class="n">g</span><span class="p">)</span>
</span><span id="__span-10-12"><a id="__codelineno-10-12" name="__codelineno-10-12" href="#__codelineno-10-12"></a>    <span class="n">E_avg</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
</span><span id="__span-10-13"><a id="__codelineno-10-13" name="__codelineno-10-13" href="#__codelineno-10-13"></a>    <span class="n">Cv</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
</span><span id="__span-10-14"><a id="__codelineno-10-14" name="__codelineno-10-14" href="#__codelineno-10-14"></a>
</span><span id="__span-10-15"><a id="__codelineno-10-15" name="__codelineno-10-15" href="#__codelineno-10-15"></a><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
</span><span id="__span-10-16"><a id="__codelineno-10-16" name="__codelineno-10-16" href="#__codelineno-10-16"></a><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">betas</span><span class="p">,</span> <span class="n">Cv</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="__span-10-17"><a id="__codelineno-10-17" name="__codelineno-10-17" href="#__codelineno-10-17"></a><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Temperature $T$&quot;</span><span class="p">)</span>
</span><span id="__span-10-18"><a id="__codelineno-10-18" name="__codelineno-10-18" href="#__codelineno-10-18"></a><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Heat Capacity $C_V$&quot;</span><span class="p">)</span>
</span><span id="__span-10-19"><a id="__codelineno-10-19" name="__codelineno-10-19" href="#__codelineno-10-19"></a><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Thermodynamics from Density of States&quot;</span><span class="p">)</span>
</span><span id="__span-10-20"><a id="__codelineno-10-20" name="__codelineno-10-20" href="#__codelineno-10-20"></a><span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-10-21"><a id="__codelineno-10-21" name="__codelineno-10-21" href="#__codelineno-10-21"></a><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</span></code></pre></div>
<p>This approach reveals phase transitions and equilibrium behavior without additional simulations.</p>
<hr />
<h3 id="advantages-and-caveats"><strong>Advantages and Caveats</strong></h3>
<table>
<thead>
<tr>
<th style="text-align: left;">Feature</th>
<th style="text-align: left;">Wang–Landau</th>
<th style="text-align: left;">Metropolis</th>
<th style="text-align: left;">Parallel Tempering</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">Sampling basis</td>
<td style="text-align: left;">Energy histogram</td>
<td style="text-align: left;">Boltzmann at fixed <span class="arithmatex">\(T\)</span></td>
<td style="text-align: left;">Multiple temperatures</td>
</tr>
<tr>
<td style="text-align: left;">Outputs</td>
<td style="text-align: left;"><span class="arithmatex">\(g(E)\)</span> for all <span class="arithmatex">\(T\)</span></td>
<td style="text-align: left;">Single-<span class="arithmatex">\(T\)</span> statistics</td>
<td style="text-align: left;">Improved exploration</td>
</tr>
<tr>
<td style="text-align: left;">Convergence</td>
<td style="text-align: left;">Slow but global</td>
<td style="text-align: left;">Fast locally</td>
<td style="text-align: left;">Moderate</td>
</tr>
<tr>
<td style="text-align: left;">Use cases</td>
<td style="text-align: left;">Phase transitions, rare states</td>
<td style="text-align: left;">Simple systems</td>
<td style="text-align: left;">Rugged landscapes</td>
</tr>
</tbody>
</table>
<p>The method excels in systems with large energy barriers or unknown phase structure, but convergence can be computationally intensive.</p>
<hr />
<h3 id="summary_3"><strong>Summary</strong></h3>
<ul>
<li>The <strong>Wang–Landau algorithm</strong> estimates the <strong>density of states</strong> <span class="arithmatex">\(g(E)\)</span> directly.</li>
<li>It uses a <strong>non-Markovian random walk</strong> to achieve flat energy sampling.</li>
<li>Once <span class="arithmatex">\(g(E)\)</span> is known, one can compute <strong>thermodynamic observables for any <span class="arithmatex">\(T\)</span></strong>.</li>
<li>This method bridges microscopic sampling and macroscopic thermodynamics —
  a beautiful finale to our exploration of advanced Monte Carlo methods.</li>
</ul>
<hr />
<h2 id="65-chapter-summary-bridge-to-part-ii"><strong>6.5 Chapter Summary &amp; Bridge to Part II</strong></h2>
<hr />
<h3 id="what-we-learned-escaping-the-energy-landscape"><strong>What We Learned: Escaping the Energy Landscape</strong></h3>
<p>In this chapter, we explored how simulations can transcend the limits of simple, local Monte Carlo updates.
We began by visualizing complex <strong>energy landscapes</strong>, where systems become trapped in local minima or move sluggishly near phase transitions.</p>
<p>From that intuition, we studied three key algorithms that <em>reshape how we explore configuration space</em>:</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Method</th>
<th style="text-align: left;">Core Idea</th>
<th style="text-align: left;">What It Fixes</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><strong>Cluster Algorithms</strong></td>
<td style="text-align: left;">Flip correlated groups of spins together</td>
<td style="text-align: left;">Overcome <strong>critical slowing down</strong> near <span class="arithmatex">\(T_c\)</span></td>
</tr>
<tr>
<td style="text-align: left;"><strong>Parallel Tempering</strong></td>
<td style="text-align: left;">Exchange configurations between different temperatures</td>
<td style="text-align: left;">Escape <strong>deep local minima</strong></td>
</tr>
<tr>
<td style="text-align: left;"><strong>Wang–Landau Sampling</strong></td>
<td style="text-align: left;">Estimate the density of states <span class="arithmatex">\(g(E)\)</span> directly</td>
<td style="text-align: left;">Sample <strong>rare states</strong> and derive thermodynamics for all <span class="arithmatex">\(T\)</span></td>
</tr>
</tbody>
</table>
<p>Each approach introduced a new way to <strong>broaden sampling</strong> beyond the limitations of a single temperature or single-spin dynamics.</p>
<p>Together, they form a <em>toolbox</em> for navigating complex landscapes — from spin systems to biomolecules.</p>
<hr />
<h3 id="conceptual-thread-across-methods"><strong>Conceptual Thread Across Methods</strong></h3>
<p>All three methods share a unifying theme:
they <strong>change the metric of exploration</strong>.</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Perspective</th>
<th style="text-align: left;">Traditional MC</th>
<th style="text-align: left;">Advanced Methods</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">Configuration space</td>
<td style="text-align: left;">Explored locally</td>
<td style="text-align: left;">Explored collectively (cluster or across replicas)</td>
</tr>
<tr>
<td style="text-align: left;">Probability weight</td>
<td style="text-align: left;">Fixed Boltzmann at single <span class="arithmatex">\(T\)</span></td>
<td style="text-align: left;">Dynamically adjusted (Wang–Landau or multi-<span class="arithmatex">\(T\)</span>)</td>
</tr>
<tr>
<td style="text-align: left;">Objective</td>
<td style="text-align: left;">Reach equilibrium at given <span class="arithmatex">\(T\)</span></td>
<td style="text-align: left;">Map the global structure of the energy landscape</td>
</tr>
</tbody>
</table>
<h2 id="in-other-words-these-techniques-extend-monte-carlo-from-being-a-thermostat-to-being-an-exploration-engine">In other words, these techniques extend Monte Carlo from being a <em>thermostat</em> to being an <em>exploration engine</em>.</h2>
<h3 id="from-monte-carlo-to-molecular-dynamics"><strong>From Monte Carlo to Molecular Dynamics</strong></h3>
<p>The end of this chapter also marks a <strong>conceptual shift</strong>.</p>
<p>Monte Carlo methods teach us how to <em>sample</em> configurations correctly.
But they do not track <em>time evolution</em> — there’s no concept of momentum or real trajectories.</p>
<p>In <strong>Part II</strong>, we move from <em>sampling</em> to <em>dynamics</em>:
we will follow how systems <em>actually move</em> in continuous time, obeying Newton’s equations or their stochastic variants.</p>
<p>This transition introduces <strong>Molecular Dynamics (MD)</strong>, where:</p>
<ul>
<li>The state is <span class="arithmatex">\((\mathbf{r}, \mathbf{p})\)</span> — positions and momenta.</li>
<li>The energy landscape defines the <strong>forces</strong>, not just probabilities.</li>
<li>The goal is to simulate <strong>real-time evolution</strong> rather than random exploration.</li>
</ul>
<hr />
<h3 id="looking-ahead_1"><strong>Looking Ahead</strong></h3>
<table>
<thead>
<tr>
<th style="text-align: left;">Monte Carlo</th>
<th style="text-align: left;">Molecular Dynamics</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">Samples from <span class="arithmatex">\(e^{-\beta E}\)</span> distribution</td>
<td style="text-align: left;">Follows <span class="arithmatex">\(\dot{\mathbf{r}} = \mathbf{p}/m\)</span>, <span class="arithmatex">\(\dot{\mathbf{p}} = -\nabla E\)</span></td>
</tr>
<tr>
<td style="text-align: left;">Discrete configurations</td>
<td style="text-align: left;">Continuous trajectories</td>
</tr>
<tr>
<td style="text-align: left;">No time scale</td>
<td style="text-align: left;">Real temporal evolution</td>
</tr>
<tr>
<td style="text-align: left;">Random moves and acceptance</td>
<td style="text-align: left;">Deterministic or stochastic integrators</td>
</tr>
</tbody>
</table>
<p>The next chapter (7) will introduce the <strong>foundations of Molecular Dynamics</strong>, bridging statistical physics and classical mechanics — the moment when our systems not only <em>jump</em> between states but <em>flow</em> through them.</p>
<hr />
<h3 id="takeaway"><strong>Takeaway</strong></h3>
<ul>
<li><strong>Energy landscapes</strong> unify our understanding of both equilibrium and dynamics.</li>
<li><strong>Advanced Monte Carlo methods</strong> help us sample those landscapes efficiently.</li>
<li>The next step is to learn how <strong>nature itself</strong> moves across these landscapes — through <strong>forces, momentum, and time</strong>.</li>
</ul>
<blockquote>
<p><em>Monte Carlo teaches us how to find where systems can go.</em>
<em>Molecular Dynamics will show us how they get there.</em></p>
</blockquote>
<hr />
<h2 id="references"><strong>References</strong></h2>
<ol>
<li>
<p><strong>Swendsen, R. H., &amp; Wang, J. S.</strong> (1987). <em>Nonuniversal critical dynamics in Monte Carlo simulations</em>. Physical Review Letters, 58(86), 86-88. [Original paper introducing cluster algorithms for the Ising model]</p>
</li>
<li>
<p><strong>Wolff, U.</strong> (1989). <em>Collective Monte Carlo updating for spin systems</em>. Physical Review Letters, 62(4), 361-364. [Seminal work on single-cluster updates that eliminate critical slowing down]</p>
</li>
<li>
<p><strong>Hukushima, K., &amp; Nemoto, K.</strong> (1996). <em>Exchange Monte Carlo method and application to spin glass simulations</em>. Journal of the Physical Society of Japan, 65(6), 1604-1608. [Foundation of parallel tempering/replica exchange methods]</p>
</li>
<li>
<p><strong>Wang, F., &amp; Landau, D. P.</strong> (2001). <em>Efficient, multiple-range random walk algorithm to calculate the density of states</em>. Physical Review Letters, 86(10), 2050-2053. [Introduces the Wang-Landau algorithm for flat histogram sampling]</p>
</li>
<li>
<p><strong>Landau, D. P., &amp; Binder, K.</strong> (2014). <em>A Guide to Monte Carlo Simulations in Statistical Physics</em> (4<sup>th</sup> ed.). Cambridge University Press. [Comprehensive textbook covering advanced Monte Carlo methods including cluster algorithms and Wang-Landau]</p>
</li>
<li>
<p><strong>Newman, M. E. J., &amp; Barkema, G. T.</strong> (1999). <em>Monte Carlo Methods in Statistical Physics</em>. Oxford University Press. [Classic reference with detailed treatment of critical phenomena and advanced sampling]</p>
</li>
<li>
<p><strong>Earl, D. J., &amp; Deem, M. W.</strong> (2005). <em>Parallel tempering: Theory, applications, and new perspectives</em>. Physical Chemistry Chemical Physics, 7(23), 3910-3916. [Review of parallel tempering applications across physics and chemistry]</p>
</li>
<li>
<p><strong>Ferrenberg, A. M., &amp; Swendsen, R. H.</strong> (1988). <em>New Monte Carlo technique for studying phase transitions</em>. Physical Review Letters, 61(23), 2635-2638. [Histogram reweighting and multiple histogram methods]</p>
</li>
<li>
<p><strong>Zhou, C., &amp; Bhatt, R. N.</strong> (2005). <em>Understanding and improving the Wang-Landau algorithm</em>. Physical Review E, 72(2), 025701. [Analysis of convergence properties and practical improvements to Wang-Landau]</p>
</li>
<li>
<p><strong>Frenkel, D., &amp; Smit, B.</strong> (2001). <em>Understanding Molecular Simulation: From Algorithms to Applications</em> (2<sup>nd</sup> ed.). Academic Press. [Authoritative text covering energy landscape navigation and advanced sampling strategies]</p>
</li>
</ol>
<hr />









  




                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../../chapter-5/Chapter-5-Essay/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Chapter-5 Stochastic Systems Biology">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Chapter-5 Stochastic Systems Biology
              </div>
            </div>
          </a>
        
        
          
          <a href="../../chapter-7/Chapter-7-Essay/" class="md-footer__link md-footer__link--next" aria-label="Next: Chapter-7 Molecular Dynamics (MD)">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Chapter-7 Molecular Dynamics (MD)
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://bigbookofcomputing.github.io" target="_blank" rel="noopener" title="bigbookofcomputing.github.io" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://x.com/bigbookofcomputing" target="_blank" rel="noopener" title="x.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M459.4 151.7c.3 4.5.3 9.1.3 13.6 0 138.7-105.6 298.6-298.6 298.6-59.5 0-114.7-17.2-161.1-47.1 8.4 1 16.6 1.3 25.3 1.3 49.1 0 94.2-16.6 130.3-44.8-46.1-1-84.8-31.2-98.1-72.8 6.5 1 13 1.6 19.8 1.6 9.4 0 18.8-1.3 27.6-3.6-48.1-9.7-84.1-52-84.1-103v-1.3c14 7.8 30.2 12.7 47.4 13.3-28.3-18.8-46.8-51-46.8-87.4 0-19.5 5.2-37.4 14.3-53C87.4 130.8 165 172.4 252.1 176.9c-1.6-7.8-2.6-15.9-2.6-24C249.5 95.1 296.3 48 354.4 48c30.2 0 57.5 12.7 76.7 33.1 23.7-4.5 46.5-13.3 66.6-25.3-7.8 24.4-24.4 44.8-46.1 57.8 21.1-2.3 41.6-8.1 60.4-16.2-14.3 20.8-32.2 39.3-52.6 54.3"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.facebook.com/bigbookofcomputing" target="_blank" rel="noopener" title="www.facebook.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M512 256C512 114.6 397.4 0 256 0S0 114.6 0 256c0 120 82.7 220.8 194.2 248.5V334.2h-52.8V256h52.8v-33.7c0-87.1 39.4-127.5 125-127.5 16.2 0 44.2 3.2 55.7 6.4V172c-6-.6-16.5-1-29.6-1-42 0-58.2 15.9-58.2 57.2V256h83.6l-14.4 78.2H287v175.9C413.8 494.8 512 386.9 512 256"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/bigbookofcomputing" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.youtube.com/@big-book-of-computing" target="_blank" rel="noopener" title="www.youtube.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M549.7 124.1c-6.2-23.7-24.8-42.3-48.3-48.6C458.9 64 288.1 64 288.1 64S117.3 64 74.7 75.5c-23.5 6.3-42 24.9-48.3 48.6C15 167 15 256.4 15 256.4s0 89.4 11.4 132.3c6.3 23.6 24.8 41.5 48.3 47.8C117.3 448 288.1 448 288.1 448s170.8 0 213.4-11.5c23.5-6.3 42-24.2 48.3-47.8 11.4-42.9 11.4-132.3 11.4-132.3s0-89.4-11.4-132.3zM232.2 337.6V175.2l142.7 81.2z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
      <div class="md-consent" data-md-component="consent" id="__consent" hidden>
        <div class="md-consent__overlay"></div>
        <aside class="md-consent__inner">
          <form class="md-consent__form md-grid md-typeset" name="consent">
            


  


<h4>Cookie consent</h4>
<p>We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of our documentation and whether users find what they're searching for. With your consent, you're helping us to make our documentation better.</p>
<input class="md-toggle" type="checkbox" id="__settings" >
<div class="md-consent__settings">
  <ul class="task-list">
    
    
      
        
  
  
    
    
  
  <li class="task-list-item">
    <label class="task-list-control">
      <input type="checkbox" name="analytics" checked>
      <span class="task-list-indicator"></span>
      Google Analytics
    </label>
  </li>

      
    
    
      
        
  
  
    
    
  
  <li class="task-list-item">
    <label class="task-list-control">
      <input type="checkbox" name="github" checked>
      <span class="task-list-indicator"></span>
      GitHub
    </label>
  </li>

      
    
    
  </ul>
</div>
<div class="md-consent__controls">
  
    
      <button class="md-button md-button--primary">Accept</button>
    
    
    
  
    
    
    
      <label class="md-button" for="__settings">Manage settings</label>
    
  
</div>
          </form>
        </aside>
      </div>
      <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout((function(){document.querySelector("[data-md-component=consent]").hidden=!1}),250);var form=document.forms.consent;for(var action of["submit","reset"])form.addEventListener(action,(function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map((function(e){return[e,!0]})))),location.hash="",location.reload()}))</script>
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../..", "features": ["announce.dismiss", "content.action.edit", "content.action.view", "content.code.annotate", "content.code.copy", "content.tooltips", "navigation.footer", "navigation.indexes", "navigation.sections", "navigation.tabs", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="../../../static/mathjax-config.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.0/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>
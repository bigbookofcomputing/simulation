
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A comprehensive guide to the foundations of stochastic simulation">
      
      
        <meta name="author" content="Big Book of Computing">
      
      
        <link rel="canonical" href="https://bigbookofcomputing.github.io/chapters/chapter-4/Chapter-4-Essay/">
      
      
        <link rel="prev" href="../../chapter-3/Chapter-3-Essay/">
      
      
        <link rel="next" href="../../chapter-5/Chapter-5-Essay/">
      
      
        
      
      
      <link rel="icon" href="../../../assets/logo.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Chapter-4 Monte Carlo Option Pricing - Big Book of Computing | Simulation</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    
      <link rel="stylesheet" href="../../../static/styles.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-ECS7B3X8JM"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-ECS7B3X8JM",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-ECS7B3X8JM",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
  
    <script>if("undefined"!=typeof __md_analytics){var consent=__md_get("__consent");consent&&consent.analytics&&__md_analytics()}</script>
  

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#chapter-4-financial-derivatives-and-monte-carlo-simulation" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Big Book of Computing | Simulation" class="md-header__button md-logo" aria-label="Big Book of Computing | Simulation" data-md-component="logo">
      
  <img src="../../../assets/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Big Book of Computing | Simulation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Chapter-4 Monte Carlo Option Pricing
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1M8 13h8v-2H8zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4a5 5 0 0 0 5-5 5 5 0 0 0-5-5"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5M7 15a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/bigbookofcomputing/simulation" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../contents/" class="md-tabs__link">
        
  
  
    
  
  Contents

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../introduction/" class="md-tabs__link">
        
  
  
    
  
  Introduction

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../chapter-1/Chapter-1-Essay/" class="md-tabs__link">
          
  
  
    
  
  Chapters

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../chapter-1/Chapter-1-WorkBook/" class="md-tabs__link">
          
  
  
    
  
  WorkBooks

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../chapter-1/Chapter-1-CodeBook/" class="md-tabs__link">
          
  
  
    
  
  CodeBooks

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Big Book of Computing | Simulation" class="md-nav__button md-logo" aria-label="Big Book of Computing | Simulation" data-md-component="logo">
      
  <img src="../../../assets/logo.png" alt="logo">

    </a>
    Big Book of Computing | Simulation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/bigbookofcomputing/simulation" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contents/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Contents
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../introduction/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Introduction
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Chapters
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            
  
    Chapters
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-1/Chapter-1-Essay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-1 Foundations of Stochastic Simulation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-2/Chapter-2-Essay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-2 The Ising Model
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-3/Chapter-3-Essay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-3 Lattice Gauge Theory
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Chapter-4 Monte Carlo Option Pricing
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-4 Monte Carlo Option Pricing
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      
        Introduction
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chapter-outline" class="md-nav__link">
    <span class="md-ellipsis">
      
        Chapter Outline
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#41-chapter-opener-probability-options-and-riskneutral-pricing" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.1 Chapter Opener: Probability, Options and Risk‑Neutral Pricing
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4.1 Chapter Opener: Probability, Options and Risk‑Neutral Pricing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#from-discrete-spins-to-financial-derivatives" class="md-nav__link">
    <span class="md-ellipsis">
      
        From discrete spins to financial derivatives
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#modeling-the-underlying-asset-geometric-brownian-motion" class="md-nav__link">
    <span class="md-ellipsis">
      
        Modeling the underlying asset: geometric Brownian motion
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from-the-physical-measure-to-the-riskneutral-measure" class="md-nav__link">
    <span class="md-ellipsis">
      
        From the physical measure to the risk‑neutral measure
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#montecarlo-pricing-under-the-riskneutral-measure" class="md-nav__link">
    <span class="md-ellipsis">
      
        Monte‑Carlo pricing under the risk‑neutral measure
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#why-montecarlo-advantages-and-limitations" class="md-nav__link">
    <span class="md-ellipsis">
      
        Why Monte‑Carlo? Advantages and limitations
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#connecting-back-to-physics-and-beyond" class="md-nav__link">
    <span class="md-ellipsis">
      
        Connecting back to physics and beyond
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#42-simulating-asset-paths-under-geometric-brownian-motion" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.2 Simulating Asset Paths Under Geometric Brownian Motion
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4.2 Simulating Asset Paths Under Geometric Brownian Motion">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#recap-the-riskneutral-gbm-model" class="md-nav__link">
    <span class="md-ellipsis">
      
        Recap: the risk‑neutral GBM model
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exact-discretization-versus-eulermaruyama" class="md-nav__link">
    <span class="md-ellipsis">
      
        Exact discretization versus Euler–Maruyama
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#choice-of-time-step-and-convergence" class="md-nav__link">
    <span class="md-ellipsis">
      
        Choice of time step and convergence
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#random-number-generation-and-quasirandom-sequences" class="md-nav__link">
    <span class="md-ellipsis">
      
        Random number generation and quasi‑random sequences
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multiasset-and-correlated-paths" class="md-nav__link">
    <span class="md-ellipsis">
      
        Multi‑asset and correlated paths
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parameter-estimation-and-calibration" class="md-nav__link">
    <span class="md-ellipsis">
      
        Parameter estimation and calibration
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#algorithmic-pseudocode" class="md-nav__link">
    <span class="md-ellipsis">
      
        Algorithmic pseudocode
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#verification-and-diagnostics" class="md-nav__link">
    <span class="md-ellipsis">
      
        Verification and diagnostics
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#43-pathdependent-options-asian-lookback-and-barrier" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.3 Path‑Dependent Options: Asian, Lookback and Barrier
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4.3 Path‑Dependent Options: Asian, Lookback and Barrier">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#classification-of-pathdependent-options" class="md-nav__link">
    <span class="md-ellipsis">
      
        Classification of path‑dependent options
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#montecarlo-algorithm-in-detail" class="md-nav__link">
    <span class="md-ellipsis">
      
        Monte‑Carlo algorithm in detail
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#implementation-nuances" class="md-nav__link">
    <span class="md-ellipsis">
      
        Implementation nuances
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#illustrative-examples" class="md-nav__link">
    <span class="md-ellipsis">
      
        Illustrative examples
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#why-path-dependence-matters" class="md-nav__link">
    <span class="md-ellipsis">
      
        Why path dependence matters
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#44-variancereduction-techniques-antithetic-variates-and-control-variates" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.4 Variance‑Reduction Techniques: Antithetic Variates and Control Variates
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4.4 Variance‑Reduction Techniques: Antithetic Variates and Control Variates">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#antithetic-variates-negative-correlation-to-the-rescue" class="md-nav__link">
    <span class="md-ellipsis">
      
        Antithetic variates: negative correlation to the rescue
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#control-variates-leveraging-known-expectations" class="md-nav__link">
    <span class="md-ellipsis">
      
        Control variates: leveraging known expectations
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stratified-sampling" class="md-nav__link">
    <span class="md-ellipsis">
      
        Stratified sampling
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#importance-sampling" class="md-nav__link">
    <span class="md-ellipsis">
      
        Importance sampling
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quasimontecarlo-qmc" class="md-nav__link">
    <span class="md-ellipsis">
      
        Quasi‑Monte‑Carlo (QMC)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#other-methods" class="md-nav__link">
    <span class="md-ellipsis">
      
        Other methods
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#choosing-the-right-technique" class="md-nav__link">
    <span class="md-ellipsis">
      
        Choosing the right technique
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#45-chapter-summary-bridge-to-chapter-5" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.5 Chapter Summary &amp; Bridge to Chapter 5
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4.5 Chapter Summary &amp; Bridge to Chapter 5">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#review-of-key-concepts" class="md-nav__link">
    <span class="md-ellipsis">
      
        Review of key concepts
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#broader-implications-and-interdisciplinary-insights" class="md-nav__link">
    <span class="md-ellipsis">
      
        Broader implications and interdisciplinary insights
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#limitations-and-outlook" class="md-nav__link">
    <span class="md-ellipsis">
      
        Limitations and outlook
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bridge-to-chapter-5-from-financial-noise-to-biological-noise" class="md-nav__link">
    <span class="md-ellipsis">
      
        Bridge to Chapter 5: from financial noise to biological noise
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      
        References
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-5/Chapter-5-Essay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-5 Stochastic Systems Biology
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-6/Chapter-6-Essay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-6 Advanced Monte Carlo Methods
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-7/Chapter-7-Essay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-7 Molecular Dynamics (MD)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-8/Chapter-8-Essay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-8 The Stochastic Calculus (SDEs)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-9/Chapter-9-Essay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-9 Black-Scholes-Merton (BSM)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-10/Chapter-10-Essay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-10 Neuroscience (Hodgkin-Huxley)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-11/Chapter-11-Essay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-11 Agent-Based & Network Models
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-12/Chapter-12-Essay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-12 Collective Behavior & Pattern Formation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-13/Chapter-13-Essay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-13 Collective Behavior & Pattern Formation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-14/Chapter-14-Essay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-14 Computational Neuroscience
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-15/Chapter-15-Essay.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-15 Graph and Network Models
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    WorkBooks
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            
  
    WorkBooks
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-1/Chapter-1-WorkBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-1 Foundations of Stochastic Simulation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-2/Chapter-2-WorkBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-2 The Ising Model
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-3/Chapter-3-WorkBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-3 Lattice Gauge Theory
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Chapter-4-WorkBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-4 Monte Carlo Option Pricing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-5/Chapter-5-WorkBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-5 Stochastic Systems Biology
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-6/Chapter-6-WorkBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-6 Advanced Monte Carlo Methods
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-7/Chapter-7-WorkBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-7 Molecular Dynamics (MD)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-8/Chapter-8-WorkBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-8 The Stochastic Calculus (SDEs)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-9/Chapter-9-WorkBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-9 Black-Scholes-Merton (BSM)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-10/Chapter-10-WorkBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-10 Neuroscience (Hodgkin-Huxley)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-11/Chapter-11-WorkBook" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-11 Agent-Based & Network Models
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-12/Chapter-12-WorkBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-12 Collective Behavior & Pattern Formation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-13/Chapter-13-WorkBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-13 Collective Behavior & Pattern Formation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-14/Chapter-14-WorkBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-14 Computational Neuroscience
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-15/Chapter-15-WorkBook.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-15 Graph and Network Models
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    CodeBooks
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            
  
    CodeBooks
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-1/Chapter-1-CodeBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-1 Foundations of Stochastic Simulation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-2/Chapter-2-CodeBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-2 The Ising Model
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-3/Chapter-3-CodeBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-3 Lattice Gauge Theory
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Chapter-4-CodeBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-4 Monte Carlo Option Pricing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-5/Chapter-5-CodeBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-5 Stochastic Systems Biology
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-6/Chapter-6-CodeBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-6 Advanced Monte Carlo Methods
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-7/Chapter-7-CodeBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-7 Molecular Dynamics (MD)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-8/Chapter-8-CodeBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-8 The Stochastic Calculus (SDEs)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-9/Chapter-9-CodeBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-9 Black-Scholes-Merton (BSM)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-10/Chapter-10-CodeBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-10 Neuroscience (Hodgkin-Huxley)
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-11/Chapter-11-CodeBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-11 Agent-Based & Network Models
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-12/Chapter-12-CodeBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-12 Collective Behavior & Pattern Formation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-13/Chapter-13-CodeBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-13 Collective Behavior & Pattern Formation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-14/Chapter-14-CodeBook/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-14 Computational Neuroscience
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chapter-15/Chapter-15-CodeBook.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Chapter-15 Graph and Network Models
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      
        Introduction
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#chapter-outline" class="md-nav__link">
    <span class="md-ellipsis">
      
        Chapter Outline
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#41-chapter-opener-probability-options-and-riskneutral-pricing" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.1 Chapter Opener: Probability, Options and Risk‑Neutral Pricing
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4.1 Chapter Opener: Probability, Options and Risk‑Neutral Pricing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#from-discrete-spins-to-financial-derivatives" class="md-nav__link">
    <span class="md-ellipsis">
      
        From discrete spins to financial derivatives
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#modeling-the-underlying-asset-geometric-brownian-motion" class="md-nav__link">
    <span class="md-ellipsis">
      
        Modeling the underlying asset: geometric Brownian motion
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#from-the-physical-measure-to-the-riskneutral-measure" class="md-nav__link">
    <span class="md-ellipsis">
      
        From the physical measure to the risk‑neutral measure
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#montecarlo-pricing-under-the-riskneutral-measure" class="md-nav__link">
    <span class="md-ellipsis">
      
        Monte‑Carlo pricing under the risk‑neutral measure
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#why-montecarlo-advantages-and-limitations" class="md-nav__link">
    <span class="md-ellipsis">
      
        Why Monte‑Carlo? Advantages and limitations
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#connecting-back-to-physics-and-beyond" class="md-nav__link">
    <span class="md-ellipsis">
      
        Connecting back to physics and beyond
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#42-simulating-asset-paths-under-geometric-brownian-motion" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.2 Simulating Asset Paths Under Geometric Brownian Motion
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4.2 Simulating Asset Paths Under Geometric Brownian Motion">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#recap-the-riskneutral-gbm-model" class="md-nav__link">
    <span class="md-ellipsis">
      
        Recap: the risk‑neutral GBM model
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exact-discretization-versus-eulermaruyama" class="md-nav__link">
    <span class="md-ellipsis">
      
        Exact discretization versus Euler–Maruyama
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#choice-of-time-step-and-convergence" class="md-nav__link">
    <span class="md-ellipsis">
      
        Choice of time step and convergence
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#random-number-generation-and-quasirandom-sequences" class="md-nav__link">
    <span class="md-ellipsis">
      
        Random number generation and quasi‑random sequences
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#multiasset-and-correlated-paths" class="md-nav__link">
    <span class="md-ellipsis">
      
        Multi‑asset and correlated paths
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#parameter-estimation-and-calibration" class="md-nav__link">
    <span class="md-ellipsis">
      
        Parameter estimation and calibration
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#algorithmic-pseudocode" class="md-nav__link">
    <span class="md-ellipsis">
      
        Algorithmic pseudocode
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#verification-and-diagnostics" class="md-nav__link">
    <span class="md-ellipsis">
      
        Verification and diagnostics
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#43-pathdependent-options-asian-lookback-and-barrier" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.3 Path‑Dependent Options: Asian, Lookback and Barrier
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4.3 Path‑Dependent Options: Asian, Lookback and Barrier">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#classification-of-pathdependent-options" class="md-nav__link">
    <span class="md-ellipsis">
      
        Classification of path‑dependent options
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#montecarlo-algorithm-in-detail" class="md-nav__link">
    <span class="md-ellipsis">
      
        Monte‑Carlo algorithm in detail
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#implementation-nuances" class="md-nav__link">
    <span class="md-ellipsis">
      
        Implementation nuances
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#illustrative-examples" class="md-nav__link">
    <span class="md-ellipsis">
      
        Illustrative examples
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#why-path-dependence-matters" class="md-nav__link">
    <span class="md-ellipsis">
      
        Why path dependence matters
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#44-variancereduction-techniques-antithetic-variates-and-control-variates" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.4 Variance‑Reduction Techniques: Antithetic Variates and Control Variates
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4.4 Variance‑Reduction Techniques: Antithetic Variates and Control Variates">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#antithetic-variates-negative-correlation-to-the-rescue" class="md-nav__link">
    <span class="md-ellipsis">
      
        Antithetic variates: negative correlation to the rescue
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#control-variates-leveraging-known-expectations" class="md-nav__link">
    <span class="md-ellipsis">
      
        Control variates: leveraging known expectations
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stratified-sampling" class="md-nav__link">
    <span class="md-ellipsis">
      
        Stratified sampling
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#importance-sampling" class="md-nav__link">
    <span class="md-ellipsis">
      
        Importance sampling
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#quasimontecarlo-qmc" class="md-nav__link">
    <span class="md-ellipsis">
      
        Quasi‑Monte‑Carlo (QMC)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#other-methods" class="md-nav__link">
    <span class="md-ellipsis">
      
        Other methods
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#choosing-the-right-technique" class="md-nav__link">
    <span class="md-ellipsis">
      
        Choosing the right technique
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#45-chapter-summary-bridge-to-chapter-5" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.5 Chapter Summary &amp; Bridge to Chapter 5
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4.5 Chapter Summary &amp; Bridge to Chapter 5">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#review-of-key-concepts" class="md-nav__link">
    <span class="md-ellipsis">
      
        Review of key concepts
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#broader-implications-and-interdisciplinary-insights" class="md-nav__link">
    <span class="md-ellipsis">
      
        Broader implications and interdisciplinary insights
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#limitations-and-outlook" class="md-nav__link">
    <span class="md-ellipsis">
      
        Limitations and outlook
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bridge-to-chapter-5-from-financial-noise-to-biological-noise" class="md-nav__link">
    <span class="md-ellipsis">
      
        Bridge to Chapter 5: from financial noise to biological noise
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      
        References
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
    <a href="https://github.com/bigbookofcomputing/simulation/edit/master/docs/chapters/chapter-4/Chapter-4-Essay.md" title="Edit this page" class="md-content__button md-icon" rel="edit">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  
    
      
    
    <a href="https://github.com/bigbookofcomputing/simulation/raw/master/docs/chapters/chapter-4/Chapter-4-Essay.md" title="View source of this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"/></svg>
    </a>
  


<h1 id="chapter-4-financial-derivatives-and-monte-carlo-simulation"><strong>Chapter 4: Financial Derivatives and Monte Carlo Simulation</strong></h1>
<hr />
<h2 id="introduction"><strong>Introduction</strong></h2>
<p>Financial derivatives—instruments whose value depends on the evolution of underlying assets—present a computational challenge remarkably similar to the problems we've encountered in statistical physics. While simple European options admit elegant closed-form solutions like the Black–Scholes–Merton formula, <strong>exotic derivatives</strong> with path-dependent payoffs, multiple correlated assets, or complex barrier conditions defy analytical treatment. An Asian option whose payoff depends on the average price over time, a barrier option that activates only if a threshold is crossed, or a basket option tied to multiple stocks—each requires computing expected values over an exponentially large space of possible price trajectories.</p>
<p>This chapter demonstrates how <strong>Monte Carlo simulation</strong> provides a universal framework for derivative pricing under the risk-neutral measure. The fundamental insight of arbitrage-free valuation is that any derivative's fair price equals the <strong>discounted expected payoff under a risk-neutral probability measure</strong> <span class="arithmatex">\(\mathbb{Q}\)</span>, where asset prices grow on average at the risk-free rate. By simulating thousands of independent price paths according to <strong>geometric Brownian motion (GBM)</strong> under <span class="arithmatex">\(\mathbb{Q}\)</span>, evaluating the payoff along each path, and averaging the results, we obtain an unbiased estimate of the option's value—regardless of how complex the payoff structure.</p>
<p>The methods we develop here directly parallel those from statistical mechanics: just as we sampled spin configurations to estimate magnetization, we now sample price trajectories to estimate option values. By the end of this chapter, you will understand how to discretize stochastic differential equations to generate GBM paths, how to implement path-dependent payoff calculations for Asian, lookback, and barrier options, and how to apply <strong>variance-reduction techniques</strong> like antithetic variates and control variates to dramatically improve computational efficiency. These foundations extend beyond finance to any domain requiring Monte Carlo integration of stochastic processes.</p>
<hr />
<h2 id="chapter-outline"><strong>Chapter Outline</strong></h2>
<table>
<thead>
<tr>
<th><strong>Sec.</strong></th>
<th><strong>Title</strong></th>
<th><strong>Core Ideas &amp; Examples</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>4.1</strong></td>
<td><strong>Chapter Opener: Probability, Options and Risk-Neutral Pricing</strong></td>
<td>From discrete spins to financial derivatives; geometric Brownian motion <span class="arithmatex">\(\mathrm{d}S_t = rS_t\mathrm{d}t + \sigma S_t\mathrm{d}W_t^{\mathbb{Q}}\)</span>; risk-neutral measure <span class="arithmatex">\(\mathbb{Q}\)</span>; option price <span class="arithmatex">\(V_0 = e^{-rT}\mathbb{E}_{\mathbb{Q}}[h(S_T)]\)</span>; advantages and limitations of Monte Carlo.</td>
</tr>
<tr>
<td><strong>4.2</strong></td>
<td><strong>Simulating Asset Paths Under Geometric Brownian Motion</strong></td>
<td>Exact discretization <span class="arithmatex">\(S_{t+\Delta t} = S_t \exp[(r - \frac{\sigma^2}{2})\Delta t + \sigma\sqrt{\Delta t} Z]\)</span>; generating standard normal variates; time-stepping algorithms; multi-asset correlations via Cholesky decomposition.</td>
</tr>
<tr>
<td><strong>4.3</strong></td>
<td><strong>Path-Dependent Options: Asian, Lookback and Barrier</strong></td>
<td>Asian options: arithmetic vs. geometric averaging; lookback options: <span class="arithmatex">\(\max(S_{\max} - K, 0)\)</span>; barrier options: knock-in/knock-out monitoring; discretization bias and continuous barrier approximations.</td>
</tr>
<tr>
<td><strong>4.4</strong></td>
<td><strong>Variance-Reduction Techniques: Antithetic Variates and Control Variates</strong></td>
<td>Antithetic paths: use <span class="arithmatex">\(-Z\)</span> to reduce variance via negative correlation; control variates: use Black-Scholes European price as control; variance reduction factors of 2-10×; stratified sampling and importance sampling.</td>
</tr>
<tr>
<td><strong>4.5</strong></td>
<td><strong>Chapter Summary &amp; Bridge to Chapter 5</strong></td>
<td>Recap of Monte Carlo option pricing; statistical error <span class="arithmatex">\(\propto 1/\sqrt{M}\)</span>; variance reduction as efficiency multiplier; preview of molecular dynamics for continuous systems; from financial trajectories to phase space evolution.</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="41-chapter-opener-probability-options-and-riskneutral-pricing"><strong>4.1 Chapter Opener: Probability, Options and Risk‑Neutral Pricing</strong></h2>
<hr />
<h3 id="from-discrete-spins-to-financial-derivatives"><strong>From discrete spins to financial derivatives</strong></h3>
<p>The previous chapters focused on statistical mechanics and quantum field theory, where the goal was to sample a probability distribution over a huge state space and compute expectations of observables. In finance we face a similar challenge: valuing a derivative requires computing the expected payoff of a contingent claim under a suitable probability measure. For simple derivatives like European calls and puts with a single underlying asset, the Black–Scholes–Merton (BSM) formula provides a closed‑form price. But <strong>exotic options</strong>—whose payoffs depend on the entire path of the asset price or on multiple correlated assets—rarely admit analytic solutions. Examples include:</p>
<ul>
<li><strong>Asian options</strong>, whose payoff depends on the average price over the contract’s life (arithmetic or geometric).</li>
<li><strong>Barrier options</strong>, which knock in or knock out if the asset price crosses a barrier.</li>
<li><strong>Lookback options</strong>, whose payoff depends on the maximum or minimum asset price achieved.</li>
<li><strong>Basket options</strong>, which depend on a weighted sum of several underlying assets.</li>
</ul>
<p>For these instruments, numerical methods are essential. Among them, <strong>Monte‑Carlo simulation</strong> is the most flexible: by simulating many possible price trajectories, we can directly compute the discounted expected payoff even when the payoff function is complicated or path‑dependent. This parallels the use of MCMC in physics, where sampling enables us to estimate observables without summing over an exponential number of microstates.</p>
<hr />
<h3 id="modeling-the-underlying-asset-geometric-brownian-motion"><strong>Modeling the underlying asset: geometric Brownian motion</strong></h3>
<p>To simulate price trajectories we need a model for the stochastic dynamics of the underlying asset. The canonical choice in quantitative finance is <strong>geometric Brownian motion (GBM)</strong>, which assumes that price changes are proportional to the current price and include a deterministic drift and a stochastic component. Under a general probability measure <span class="arithmatex">\(\mathbb{P}\)</span> the dynamics are given by the stochastic differential equation (SDE):</p>
<div class="arithmatex">\[
\mathrm{d}S_t = \mu S_t\,\mathrm{d}t + \sigma S_t\,\mathrm{d}W_t,
\]</div>
<p>where <span class="arithmatex">\(S_t\)</span> is the asset price at time <span class="arithmatex">\(t\)</span>, <span class="arithmatex">\(\mu\)</span> is its drift (the expected return), <span class="arithmatex">\(\sigma\)</span> is its volatility and <span class="arithmatex">\(W_t\)</span> is a standard Brownian motion. This SDE has the closed‑form solution</p>
<div class="arithmatex">\[
S_t = S_0 \exp\left[\left(\mu - \tfrac{\sigma^2}{2}\right)t + \sigma W_t\right],
\]</div>
<p>so that <span class="arithmatex">\(\log S_t\)</span> is normally distributed and <span class="arithmatex">\(S_t\)</span> is log‑normal. GBM is mathematically convenient: it guarantees positive prices and leads to tractable pricing formulas in the BSM framework. More sophisticated models incorporate stochastic volatility, jumps or mean reversion, but GBM remains the workhorse for illustrating Monte‑Carlo pricing.</p>
<hr />
<h3 id="from-the-physical-measure-to-the-riskneutral-measure"><strong>From the physical measure to the risk‑neutral measure</strong></h3>
<p>In the physical (real‑world) measure <span class="arithmatex">\(\mathbb{P}\)</span>, the drift <span class="arithmatex">\(\mu\)</span> equals the asset’s expected return, which includes a risk premium. However, derivative pricing is governed by <strong>arbitrage‑free valuation</strong>: in a frictionless market with no arbitrage opportunities, any derivative can be replicated (at least approximately) by dynamic trading in the underlying asset and a riskless bond. This implies that there exists an equivalent probability measure <span class="arithmatex">\(\mathbb{Q}\)</span> such that <strong>discounted asset prices are martingales</strong>. Under this <strong>risk‑neutral measure</strong>, the drift of the asset equals the risk‑free interest rate <span class="arithmatex">\(r\)</span>. The GBM SDE becomes</p>
<div class="arithmatex">\[
\mathrm{d}S_t = r S_t\,\mathrm{d}t + \sigma S_t\,\mathrm{d}W_t^{\mathbb{Q}},
\]</div>
<p>where <span class="arithmatex">\(W_t^{\mathbb{Q}}\)</span> is a Brownian motion under <span class="arithmatex">\(\mathbb{Q}\)</span>. The risk‑neutral drift <span class="arithmatex">\(r\)</span> ensures that the expected growth of the asset is exactly the risk‑free return, reflecting the fact that any excess return above <span class="arithmatex">\(r\)</span> would be offset by a hedging strategy.</p>
<p>The <strong>fundamental theorem of asset pricing</strong> then states that the fair price <span class="arithmatex">\(V_0\)</span> of a derivative with payoff <span class="arithmatex">\(h(S_T)\)</span> at maturity <span class="arithmatex">\(T\)</span> is given by the <strong>discounted risk‑neutral expectation</strong>:</p>
<div class="arithmatex">\[
V_0 = e^{-rT} \mathbb{E}_{\mathbb{Q}} \left[h(S_T)\right].
\]</div>
<p>More generally, if the payoff depends on the entire path <span class="arithmatex">\(\{S_t\}_{0\le t\le T}\)</span>, we compute the expected value of <span class="arithmatex">\(h(\{S_t\})\)</span> under <span class="arithmatex">\(\mathbb{Q}\)</span> and discount it by <span class="arithmatex">\(e^{-rT}\)</span>.</p>
<div class="admonition tip">
<p class="admonition-title">Why the Risk-Free Rate as Drift?</p>
<p>Under the risk-neutral measure, the expected return of any tradable asset must equal the risk-free rate <span class="arithmatex">\(r\)</span> to prevent arbitrage. If <span class="arithmatex">\(S_t\)</span> had expected return <span class="arithmatex">\(\mu &gt; r\)</span>, one could borrow at rate <span class="arithmatex">\(r\)</span>, invest in <span class="arithmatex">\(S_t\)</span>, and lock in riskless profit. The change from physical measure <span class="arithmatex">\(\mathbb{P}\)</span> (drift <span class="arithmatex">\(\mu\)</span>) to risk-neutral measure <span class="arithmatex">\(\mathbb{Q}\)</span> (drift <span class="arithmatex">\(r\)</span>) is achieved via Girsanov's theorem, which adjusts the Brownian motion by the market price of risk.</p>
</div>
<hr />
<h3 id="montecarlo-pricing-under-the-riskneutral-measure"><strong>Monte‑Carlo pricing under the risk‑neutral measure</strong></h3>
<p>Monte‑Carlo simulation estimates the risk‑neutral expectation by generating many independent realizations of the underlying asset path and averaging their payoffs. The basic steps are:</p>
<ol>
<li><strong>Discretize time:</strong> Partition the interval <span class="arithmatex">\([0,T]\)</span> into <span class="arithmatex">\(N\)</span> steps of length <span class="arithmatex">\(\Delta t\)</span>.</li>
<li><strong>Generate random paths:</strong> Starting from <span class="arithmatex">\(S_0\)</span>, use the exact GBM discretization</li>
</ol>
<p>$$
   S_{t_{k+1}} = S_{t_k} \exp\left[\left(r - \tfrac{\sigma^2}{2}\right)\Delta t + \sigma \sqrt{\Delta t}\,Z_k\right],
   $$</p>
<p>where <span class="arithmatex">\(Z_k\)</span> are independent standard normal variates. Repeat this to obtain <span class="arithmatex">\(M\)</span> independent paths <span class="arithmatex">\(\{S_{t_0}^{(m)}, S_{t_1}^{(m)}, \dots, S_{t_N}^{(m)}\}\)</span>.
3. <strong>Compute payoffs:</strong> For each path <span class="arithmatex">\(m\)</span>, evaluate the payoff <span class="arithmatex">\(h_m\)</span> of the derivative. For a European call, <span class="arithmatex">\(h_m = \max(S_{t_N}^{(m)} - K, 0)\)</span>; for a path‑dependent option, <span class="arithmatex">\(h_m\)</span> might involve an average, a maximum/minimum or barrier monitoring.
4. <strong>Average and discount:</strong> Estimate the option price by</p>
<p>$$
   \hat{V}<em m="1">0 = e^{-rT} \frac{1}{M} \sum</em>^M h_m.
   $$</p>
<p>As in physical Monte‑Carlo simulations, the estimator's standard error decreases as <span class="arithmatex">\(1/\sqrt{M}\)</span>. Doubling precision requires quadrupling the number of paths. The flexibility of this method is immense: you can incorporate multiple assets, correlated Brownian motions, stochastic volatilities or jumps. The only requirement is that you can simulate the underlying process under the risk‑neutral measure.</p>
<div class="admonition example">
<p class="admonition-title">Pricing a European Call with Monte Carlo</p>
<p>Consider <span class="arithmatex">\(S_0 = 100\)</span>, <span class="arithmatex">\(K = 105\)</span>, <span class="arithmatex">\(r = 0.05\)</span>, <span class="arithmatex">\(\sigma = 0.20\)</span>, <span class="arithmatex">\(T = 1\)</span> year. With <span class="arithmatex">\(M = 10{,}000\)</span> paths:</p>
<ol>
<li>For each path <span class="arithmatex">\(m\)</span>: generate <span class="arithmatex">\(Z \sim N(0,1)\)</span>, compute <span class="arithmatex">\(S_T^{(m)} = 100 \exp[(0.05 - 0.5 \times 0.2^2) + 0.2 Z]\)</span></li>
<li>Payoff: <span class="arithmatex">\(h_m = \max(S_T^{(m)} - 105, 0)\)</span></li>
<li>Estimate: <span class="arithmatex">\(\hat{V}_0 = e^{-0.05} \times \frac{1}{10000}\sum h_m \approx 8.02\)</span></li>
</ol>
<p>The Black-Scholes formula gives <span class="arithmatex">\(V_0 = 8.02\)</span>. Standard error <span class="arithmatex">\(\approx 0.15\)</span>, so the estimate is accurate within <span class="arithmatex">\(\pm 0.30\)</span> at 95% confidence.</p>
</div>
<hr />
<h3 id="why-montecarlo-advantages-and-limitations"><strong>Why Monte‑Carlo? Advantages and limitations</strong></h3>
<p><strong>Advantages:</strong></p>
<ul>
<li><strong>Generality:</strong> Monte‑Carlo can price almost any derivative, including highly path‑dependent and multi‑asset options. It is particularly valuable when no analytic or lattice‑based method exists.</li>
<li><strong>Easy to implement:</strong> The basic algorithm—simulate paths, compute payoffs, average—is conceptually straightforward and highly parallelizable.</li>
<li><strong>Extensible:</strong> By changing the SDE or adding dimensions, one can model stochastic volatility, interest rates, or jump processes without significant structural changes.</li>
</ul>
<p><strong>Limitations:</strong></p>
<ul>
<li><strong>Slow convergence:</strong> The <span class="arithmatex">\(1/\sqrt{M}\)</span> convergence rate implies that Monte‑Carlo is computationally intensive. For precise pricing of options with small Vega or deep out‑of‑the‑money barrier options, millions of paths may be required.</li>
<li><strong>Variance:</strong> Estimators can exhibit high variance, particularly for options where the payoff is sensitive to rare events (e.g., digital options, deep barriers). Variance‑reduction techniques like antithetic variates and control variates (discussed in §4.4) are essential to improve efficiency.</li>
<li><strong>Model risk:</strong> The accuracy of the price depends on the correctness of the assumed stochastic model (GBM). Real markets exhibit jumps, volatility clustering and fat tails; such effects can significantly alter option prices if ignored. More advanced models (Heston, Merton jump–diffusion, variance gamma) address these issues at additional computational cost.</li>
</ul>
<details class="question">
<summary>When Should You Use Monte Carlo Instead of Black-Scholes?</summary>
<p>Use Monte Carlo when:
- The option is path-dependent (Asian, barrier, lookback) with no closed-form solution
- Multiple correlated assets are involved (basket options)
- Complex early exercise features exist (American with path dependence)
- You need to model stochastic volatility or jumps</p>
<p>Stick with analytical formulas when they exist (European vanilla) for speed and precision. For American options on single assets, binomial trees or finite difference methods are often more efficient than Monte Carlo.</p>
</details>
<hr />
<h3 id="connecting-back-to-physics-and-beyond"><strong>Connecting back to physics and beyond</strong></h3>
<p>There is a deep conceptual link between the Monte‑Carlo methods used to sample the Boltzmann distribution in statistical mechanics and those used to compute risk‑neutral expectations in finance:</p>
<ul>
<li>In physics, the <strong>state space</strong> is the set of microstates of a system (e.g., spin configurations, gauge fields); in finance it is the set of possible price paths.</li>
<li>The <strong>probability measure</strong> is given by the Boltzmann factor <span class="arithmatex">\(\exp(-\beta E)\)</span> in physics and by the risk‑neutral measure <span class="arithmatex">\(\exp(-rT)\)</span> weighted over stochastic paths in finance.</li>
<li>The <strong>observable</strong> is a physical quantity like magnetization or energy in physics, and a payoff function like <span class="arithmatex">\(\max(S_T - K, 0)\)</span> in finance.</li>
<li>The <strong>estimator</strong> is the sample mean of the observable over simulated states or paths; its variance determines the required number of samples.</li>
</ul>
<p>In both domains, Monte‑Carlo is a universal tool for high‑dimensional integration. The subsequent sections of Chapter 4 (and later chapters in other domains) will build on this foundation: simulating GBM paths (§4.2), implementing path‑dependent payoffs (§4.3), reducing variance (§4.4) and drawing broader lessons (§4.5).</p>
<hr />
<h2 id="42-simulating-asset-paths-under-geometric-brownian-motion"><strong>4.2 Simulating Asset Paths Under Geometric Brownian Motion</strong></h2>
<hr />
<h3 id="recap-the-riskneutral-gbm-model"><strong>Recap: the risk‑neutral GBM model</strong></h3>
<p>Under the risk‑neutral measure <span class="arithmatex">\(\mathbb{Q}\)</span>, a single asset price <span class="arithmatex">\(S_t\)</span> evolves according to the stochastic differential equation (SDE)</p>
<div class="arithmatex">\[
\mathrm{d}S_t = r S_t\,\mathrm{d}t + \sigma S_t\,\mathrm{d}W_t^{\mathbb{Q}},
\]</div>
<p>where <span class="arithmatex">\(r\)</span> is the risk‑free rate, <span class="arithmatex">\(\sigma\)</span> the volatility and <span class="arithmatex">\(W_t^{\mathbb{Q}}\)</span> a standard Brownian motion. The exact solution is</p>
<div class="arithmatex">\[
S_t = S_0 \exp\left[\left(r - \tfrac{\sigma^2}{2}\right)t + \sigma W_t^{\mathbb{Q}}\right],
\]</div>
<p>so that <span class="arithmatex">\(\log S_t\)</span> is normally distributed with mean <span class="arithmatex">\(\log S_0 + \left(r - \tfrac{\sigma^2}{2}\right)t\)</span> and variance <span class="arithmatex">\(\sigma^2 t\)</span>. Simulating GBM paths requires discretizing this continuous‑time process into finite time steps.</p>
<hr />
<h3 id="exact-discretization-versus-eulermaruyama"><strong>Exact discretization versus Euler–Maruyama</strong></h3>
<p>Because the GBM SDE is linear in <span class="arithmatex">\(S_t\)</span>, we can discretize it exactly. Partition the interval <span class="arithmatex">\([0,T]\)</span> into <span class="arithmatex">\(N\)</span> equally spaced times <span class="arithmatex">\(t_k = k\Delta t\)</span> with <span class="arithmatex">\(\Delta t = T/N\)</span>. Then</p>
<div class="arithmatex">\[
S_{t_{k+1}} = S_{t_k} \exp\left[\left(r - \tfrac{\sigma^2}{2}\right)\Delta t + \sigma \sqrt{\Delta t} Z_k\right],
\]</div>
<p>where <span class="arithmatex">\(Z_k\)</span> are independent standard normal random variables. This update formula is sometimes called the <strong>exact discretization</strong> because it samples the exact distribution of GBM at discrete times.</p>
<p>For more general SDEs (e.g., with state‑dependent volatility), one often uses the <strong>Euler–Maruyama method</strong>:</p>
<div class="arithmatex">\[
S_{t_{k+1}}^{\text{Euler}} = S_{t_k} + r S_{t_k} \Delta t + \sigma S_{t_k} \sqrt{\Delta t} Z_k.
\]</div>
<p>This is a first‑order numerical scheme whose error in the expected value is <span class="arithmatex">\(O(\Delta t)\)</span>. For GBM the exact exponential update is preferred because it avoids discretization bias and preserves the log‑normal distribution; nonetheless, it is instructive to understand Euler–Maruyama as it generalizes to SDEs without closed‑form solutions (e.g., stochastic volatility models).</p>
<hr />
<h3 id="choice-of-time-step-and-convergence"><strong>Choice of time step and convergence</strong></h3>
<p>The <strong>time step <span class="arithmatex">\(\Delta t\)</span></strong> determines the resolution of the simulated path. Key considerations:</p>
<ul>
<li>
<p><strong>Path‑dependent options:</strong> If the payoff depends on the maximum, minimum or average price along the path (e.g., barrier or Asian options), <span class="arithmatex">\(\Delta t\)</span> must be small enough to capture price fluctuations that could trigger barrier crossings or affect the average. A coarse grid may underestimate the probability of hitting a barrier or miscompute the average price. There is a trade‑off: halving <span class="arithmatex">\(\Delta t\)</span> roughly doubles the number of computations. In practice one performs a convergence test by halving <span class="arithmatex">\(\Delta t\)</span> until the estimated price stabilizes within a desired tolerance.</p>
</li>
<li>
<p><strong>Quadratic variation:</strong> For SDEs like GBM, the quadratic variation of the process is <span class="arithmatex">\(\langle (S_{t+\Delta t}-S_t)^2\rangle \approx \sigma^2 S_t^2 \Delta t\)</span>. If <span class="arithmatex">\(\Delta t\)</span> is too large, one may not resolve the volatility dynamics; if it is too small, computational cost increases without significant gain in accuracy.</p>
</li>
<li>
<p><strong>Brownian bridge adjustments:</strong> For barrier options, one can use Brownian bridge techniques to refine the probability of barrier crossing between time steps, reducing the need for extremely small <span class="arithmatex">\(\Delta t\)</span>.</p>
</li>
</ul>
<hr />
<h3 id="random-number-generation-and-quasirandom-sequences"><strong>Random number generation and quasi‑random sequences</strong></h3>
<p>The quality of Monte‑Carlo simulation hinges on the quality of the random numbers used to generate <span class="arithmatex">\(Z_k\)</span>. Key points:</p>
<ul>
<li>
<p>Use a robust pseudorandom number generator (PRNG) with a long period and good statistical properties to produce independent <span class="arithmatex">\(U(0,1)\)</span> variates, then transform them to standard normals via the Box–Muller or Ziggurat method.</p>
</li>
<li>
<p><strong>Antithetic variates:</strong> To reduce variance, one can generate <span class="arithmatex">\(Z_k\)</span> in pairs <span class="arithmatex">\((Z_k, -Z_k)\)</span>, ensuring that the antithetic path uses the negative of the random shocks. This technique is discussed further in §4.4 and improves estimator precision without additional random variates.</p>
</li>
<li>
<p><strong>Quasi‑Monte‑Carlo:</strong> Instead of pseudorandom numbers, low‑discrepancy sequences (Sobol’, Halton) can be employed. These sequences cover the unit hypercube more uniformly than pseudorandom numbers, potentially reducing integration error faster than <span class="arithmatex">\(1/\sqrt{M}\)</span>. However, their effectiveness diminishes in very high dimensions (large <span class="arithmatex">\(N\)</span>).</p>
</li>
</ul>
<hr />
<h3 id="multiasset-and-correlated-paths"><strong>Multi‑asset and correlated paths</strong></h3>
<p>Many derivatives involve multiple underlying assets (e.g., basket options, spread options). If we model each asset <span class="arithmatex">\(S_t^{(i)}\)</span> as a GBM with its own volatility <span class="arithmatex">\(\sigma_i\)</span> and Brownian motion <span class="arithmatex">\(W_t^{(i)}\)</span>, we must account for correlations <span class="arithmatex">\(\rho_{ij}\)</span> between the Brownian motions. The correlated SDEs are</p>
<div class="arithmatex">\[
\mathrm{d}S_t^{(i)} = r S_t^{(i)}\,\mathrm{d}t + \sigma_i S_t^{(i)}\,\mathrm{d}W_t^{(i)},\quad
\mathrm{d}W_t^{(i)}\,\mathrm{d}W_t^{(j)} = \rho_{ij}\,\mathrm{d}t.
\]</div>
<p>To simulate correlated increments, one can:</p>
<ol>
<li>Compute a <strong>Cholesky decomposition</strong> <span class="arithmatex">\(C\)</span> of the correlation matrix <span class="arithmatex">\(\rho\)</span> such that <span class="arithmatex">\(\rho = C C^\top\)</span>.</li>
<li>Draw independent standard normals <span class="arithmatex">\(Z_k^{(1)}, \dots, Z_k^{(d)}\)</span>.</li>
<li>Set correlated normals as <span class="arithmatex">\(Y_k = C Z_k\)</span>; then <span class="arithmatex">\(Y_k^{(i)}\)</span> has the desired covariances.</li>
</ol>
<p>Update each asset using the exact discretization:</p>
<div class="arithmatex">\[
S_{t_{k+1}}^{(i)} = S_{t_k}^{(i)} \exp\left[\left(r - \tfrac{\sigma_i^2}{2}\right)\Delta t + \sigma_i \sqrt{\Delta t} Y_k^{(i)}\right].
\]</div>
<p>This procedure allows pricing of multi‑asset exotics and baskets with proper correlation structure.</p>
<hr />
<h3 id="parameter-estimation-and-calibration"><strong>Parameter estimation and calibration</strong></h3>
<p>Before simulating GBM paths, the parameters <span class="arithmatex">\(r\)</span>, <span class="arithmatex">\(\sigma\)</span> and <span class="arithmatex">\(S_0\)</span> must be specified:</p>
<ul>
<li>
<p><strong>Risk‑free rate (<span class="arithmatex">\(r\)</span>):</strong> Use the continuously compounded yield of a zero‑coupon government bond or the relevant discount curve.</p>
</li>
<li>
<p><strong>Initial price (<span class="arithmatex">\(S_0\)</span>):</strong> The current market price of the underlying asset.</p>
</li>
<li>
<p><strong>Volatility (<span class="arithmatex">\(\sigma\)</span>):</strong> This can be estimated in various ways. <strong>Historical volatility</strong> uses time series of past returns; <strong>implied volatility</strong> solves for <span class="arithmatex">\(\sigma\)</span> in the BSM formula to match observed option prices. For Monte‑Carlo pricing of exotics, implied volatility from at‑the‑money vanilla options at similar maturities is typically used. Some models assume constant <span class="arithmatex">\(\sigma\)</span>, while more sophisticated ones treat volatility as stochastic; for the latter, one must simulate an additional SDE (e.g., Heston model) alongside the asset price.</p>
</li>
</ul>
<p>Calibration ensures that the simulation reflects current market expectations. Mis‑calibrated parameters lead to biased prices and mis‑estimated risk.</p>
<hr />
<h3 id="algorithmic-pseudocode"><strong>Algorithmic pseudocode</strong></h3>
<p>Putting it all together, a typical Monte‑Carlo routine for a single‑asset exotic might look like:</p>
<p><strong>Pseudo-code for Monte Carlo Option Pricing:</strong></p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="c1"># Monte Carlo pricing for path-dependent options</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="k">def</span><span class="w"> </span><span class="nf">monte_carlo_option_price</span><span class="p">(</span><span class="n">S0</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">payoff_func</span><span class="p">):</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="sd">    S0: initial asset price</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="sd">    r: risk-free rate</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="sd">    sigma: volatility</span>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="sd">    T: time to maturity</span>
</span><span id="__span-0-8"><a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="sd">    N: number of time steps</span>
</span><span id="__span-0-9"><a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="sd">    M: number of simulation paths</span>
</span><span id="__span-0-10"><a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="sd">    payoff_func: function computing payoff from path</span>
</span><span id="__span-0-11"><a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="__span-0-12"><a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a>    <span class="n">dt</span> <span class="o">=</span> <span class="n">T</span> <span class="o">/</span> <span class="n">N</span>
</span><span id="__span-0-13"><a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a>    <span class="n">drift</span> <span class="o">=</span> <span class="p">(</span><span class="n">r</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">sigma</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">dt</span>
</span><span id="__span-0-14"><a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a>    <span class="n">diffusion</span> <span class="o">=</span> <span class="n">sigma</span> <span class="o">*</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">dt</span><span class="p">)</span>
</span><span id="__span-0-15"><a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a>
</span><span id="__span-0-16"><a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a>    <span class="n">payoffs</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="__span-0-17"><a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a>    <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">M</span><span class="p">):</span>
</span><span id="__span-0-18"><a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a>        <span class="c1"># Simulate one path</span>
</span><span id="__span-0-19"><a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a>        <span class="n">S</span> <span class="o">=</span> <span class="n">S0</span>
</span><span id="__span-0-20"><a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a>        <span class="n">path</span> <span class="o">=</span> <span class="p">[</span><span class="n">S</span><span class="p">]</span>
</span><span id="__span-0-21"><a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a>        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
</span><span id="__span-0-22"><a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a>            <span class="n">Z</span> <span class="o">=</span> <span class="n">random_normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="__span-0-23"><a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a>            <span class="n">S</span> <span class="o">=</span> <span class="n">S</span> <span class="o">*</span> <span class="n">exp</span><span class="p">(</span><span class="n">drift</span> <span class="o">+</span> <span class="n">diffusion</span> <span class="o">*</span> <span class="n">Z</span><span class="p">)</span>
</span><span id="__span-0-24"><a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a>            <span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">S</span><span class="p">)</span>
</span><span id="__span-0-25"><a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a>
</span><span id="__span-0-26"><a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a>        <span class="c1"># Compute payoff for this path</span>
</span><span id="__span-0-27"><a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a>        <span class="n">h_m</span> <span class="o">=</span> <span class="n">payoff_func</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</span><span id="__span-0-28"><a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a>        <span class="n">payoffs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">h_m</span><span class="p">)</span>
</span><span id="__span-0-29"><a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a>
</span><span id="__span-0-30"><a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a>    <span class="c1"># Estimate option price</span>
</span><span id="__span-0-31"><a id="__codelineno-0-31" name="__codelineno-0-31" href="#__codelineno-0-31"></a>    <span class="n">V_hat</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">r</span> <span class="o">*</span> <span class="n">T</span><span class="p">)</span> <span class="o">*</span> <span class="n">mean</span><span class="p">(</span><span class="n">payoffs</span><span class="p">)</span>
</span><span id="__span-0-32"><a id="__codelineno-0-32" name="__codelineno-0-32" href="#__codelineno-0-32"></a>    <span class="n">std_error</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">r</span> <span class="o">*</span> <span class="n">T</span><span class="p">)</span> <span class="o">*</span> <span class="n">std</span><span class="p">(</span><span class="n">payoffs</span><span class="p">)</span> <span class="o">/</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
</span><span id="__span-0-33"><a id="__codelineno-0-33" name="__codelineno-0-33" href="#__codelineno-0-33"></a>
</span><span id="__span-0-34"><a id="__codelineno-0-34" name="__codelineno-0-34" href="#__codelineno-0-34"></a>    <span class="k">return</span> <span class="n">V_hat</span><span class="p">,</span> <span class="n">std_error</span>
</span></code></pre></div>
<p>For multi‑asset options, the inner loop generates correlated <span class="arithmatex">\(Y_k\)</span> and updates each asset price accordingly.</p>
<hr />
<h3 id="verification-and-diagnostics"><strong>Verification and diagnostics</strong></h3>
<p>To ensure the simulation is correctly implemented:</p>
<ul>
<li>
<p><strong>Distribution check:</strong> For a given <span class="arithmatex">\(\Delta t\)</span> simulate many one‑step updates and verify that <span class="arithmatex">\(\log(S_{t+\Delta t}/S_t)\)</span> has mean <span class="arithmatex">\((r - \tfrac{\sigma^2}{2})\Delta t\)</span> and variance <span class="arithmatex">\(\sigma^2 \Delta t\)</span>.</p>
</li>
<li>
<p><strong>Moment matching:</strong> Compare sample moments (mean, variance) of <span class="arithmatex">\(S_T\)</span> across all paths with theoretical values. For GBM, <span class="arithmatex">\(\mathbb{E}[S_T] = S_0 e^{rT}\)</span> and <span class="arithmatex">\(\mathrm{Var}(S_T) = S_0^2 e^{2rT}(e^{\sigma^2 T} - 1)\)</span>.</p>
</li>
<li>
<p><strong>Convergence testing:</strong> Doubling <span class="arithmatex">\(M\)</span> and halving <span class="arithmatex">\(\Delta t\)</span> should not produce significant changes in the estimated price. Plotting price estimates versus <span class="arithmatex">\(\Delta t\)</span> can reveal discretization bias.</p>
</li>
<li>
<p><strong>Correlation tests:</strong> For multi‑asset simulations, compute empirical correlations of simulated returns and compare them with the target correlation matrix.</p>
</li>
</ul>
<p>By following these steps, one builds confidence that the simulated paths accurately reflect the risk‑neutral dynamics assumed in the pricing model. These simulations form the basis for evaluating complex derivatives in the subsequent sections of this chapter.</p>
<p><strong>Flowchart: Monte Carlo Option Pricing Workflow</strong></p>
<pre class="mermaid"><code>graph TD
    A[Start: Option Specification] --&gt; B[Define Parameters: S0, r, σ, T, K]
    B --&gt; C[Choose Time Steps N and Paths M]

    C --&gt; D[Initialize Path Counter m=1]
    D --&gt; E[Set S = S0, Initialize Path Statistics]

    E --&gt; F[Time Loop: k=1 to N]
    F --&gt; G[Generate Z ~ N 0,1]
    G --&gt; H[Update: S = S × exp drift + diffusion×Z]

    H --&gt; I{Path-Dependent?}
    I --&gt;|Asian| J[Accumulate sum += S]
    I --&gt;|Lookback| K[Update max/min]
    I --&gt;|Barrier| L[Check barrier crossing]
    I --&gt;|European| M[Store only S_T]

    J --&gt; N[Next Time Step]
    K --&gt; N
    L --&gt; N
    M --&gt; N

    N --&gt; O{k &lt; N?}
    O --&gt;|Yes| F
    O --&gt;|No| P[Compute Payoff h_m]

    P --&gt; Q{m &lt; M?}
    Q --&gt;|Yes| R[m = m + 1]
    R --&gt; E

    Q --&gt;|No| S[Average Payoffs: V̂ = e^-rT × mean h_m]
    S --&gt; T[Compute Standard Error: σ/√M]
    T --&gt; U[Return Price Estimate and Confidence Interval]

    style S fill:#ffff99
    style U fill:#99ff99</code></pre>
<hr />
<h2 id="43-pathdependent-options-asian-lookback-and-barrier"><strong>4.3 Path‑Dependent Options: Asian, Lookback and Barrier</strong></h2>
<hr />
<p>In contrast to plain vanilla options whose payoff depends solely on the terminal asset price, <strong>path‑dependent options</strong> derive their value from the entire trajectory of the underlying asset over the option’s life. Such instruments are ubiquitous in commodity markets, foreign exchange, energy contracts and structured products because they allow tailored risk management. However, they are analytically intractable, making simulation techniques indispensable.</p>
<h3 id="classification-of-pathdependent-options"><strong>Classification of path‑dependent options</strong></h3>
<ol>
<li>
<p><strong>Asian options (average price or average strike).</strong></p>
</li>
<li>
<p><strong>Arithmetic‑average Asian call</strong>: payoff <span class="arithmatex">\(h = \max(\bar{S} - K, 0)\)</span>, where <span class="arithmatex">\(\bar{S} = \frac{1}{N+1}\sum_{k=0}^N S_{t_k}\)</span> is the arithmetic average. Because the arithmetic average of a log‑normal process is not log‑normal, there is no closed‑form solution; hence Monte‑Carlo is the standard pricing approach.</p>
</li>
<li><strong>Geometric‑average Asian call</strong>: payoff <span class="arithmatex">\(h = \max(G - K, 0)\)</span>, where <span class="arithmatex">\(G = \left(\prod_{k=0}^N S_{t_k}\right)^{1/(N+1)}\)</span>. The geometric mean of log‑normal variables is log‑normal, permitting a closed‑form price. This closed form can serve as a control variate when pricing arithmetic Asians (§4.4).</li>
<li>
<p><strong>Average strike options</strong>: the strike is the average price; the payoff is <span class="arithmatex">\(\max(S_T - \bar{S}, 0)\)</span>.</p>
</li>
<li>
<p><strong>Lookback options.</strong></p>
</li>
<li>
<p><strong>Fixed strike lookback call</strong>: payoff <span class="arithmatex">\(h = \max(M_{\max} - K, 0)\)</span>, where <span class="arithmatex">\(M_{\max} = \max_{0\le k\le N} S_{t_k}\)</span>. The holder can “look back” at the maximum price attained and exercise accordingly. There are also lookback puts based on the minimum price.</p>
</li>
<li>
<p><strong>Floating strike lookback call/put</strong>: strike equals <span class="arithmatex">\(M_{\min}\)</span> or <span class="arithmatex">\(M_{\max}\)</span>. For example, a floating strike lookback call has payoff <span class="arithmatex">\(S_T - M_{\min}\)</span>; a lookback put has <span class="arithmatex">\(M_{\max} - S_T\)</span>.</p>
</li>
<li>
<p><strong>Barrier options.</strong></p>
</li>
<li>
<p><strong>Up‑and‑out / down‑and‑out options</strong>: become worthless if the asset price ever crosses an upper or lower barrier. For an up‑and‑out call with barrier <span class="arithmatex">\(B\)</span>, the payoff is <span class="arithmatex">\(\max(S_T - K,0)\)</span> if <span class="arithmatex">\(S_t &lt; B\)</span> for all <span class="arithmatex">\(t \le T\)</span>; otherwise zero.</p>
</li>
<li><strong>Up‑and‑in / down‑and‑in options</strong>: activate only if the price crosses a barrier.</li>
<li>
<p><strong>Double barrier options</strong>: extinguish or activate upon crossing either of two barriers (e.g., double knock‑out). Energy and FX markets use such structures to cap exposures.</p>
</li>
<li>
<p><strong>Cliquet and ratchet options.</strong> These are series of forward‑starting options where the payoff depends on periodic resets of the strike and running sums of returns. Pricing often requires Monte‑Carlo or lattice methods due to their path dependence.</p>
</li>
<li>
<p><strong>Asian barriers and lookback barriers.</strong> More exotic features can be combined: an option may pay based on the average but knock out if a barrier is breached.</p>
</li>
</ol>
<p>The common thread is that one must track some functional of the path—an average, a maximum, minimum or barrier hit indicator—when simulating.</p>
<hr />
<h3 id="montecarlo-algorithm-in-detail"><strong>Monte‑Carlo algorithm in detail</strong></h3>
<p>While the high‑level algorithm outlined in §4.1 suffices, path‑dependent options require careful book‑keeping of path statistics:</p>
<ol>
<li>
<p><strong>Initialization.</strong> Set parameters <span class="arithmatex">\(S_0\)</span>, <span class="arithmatex">\(r\)</span>, <span class="arithmatex">\(\sigma\)</span>, maturity <span class="arithmatex">\(T\)</span>, number of time steps <span class="arithmatex">\(N\)</span> and number of paths <span class="arithmatex">\(M\)</span>. Determine the payoff function <span class="arithmatex">\(h(\text{path})\)</span> according to the option type.</p>
</li>
<li>
<p><strong>Simulate paths.</strong> For each simulation <span class="arithmatex">\(m=1,\dots,M\)</span>:</p>
</li>
<li>
<p>Initialize variables: set <span class="arithmatex">\(S=S_0\)</span>; set running sums or extrema (e.g., <span class="arithmatex">\(\text{sum}=S_0\)</span> for an Asian option; <span class="arithmatex">\(\text{max}=S_0\)</span>, <span class="arithmatex">\(\text{min}=S_0\)</span> for lookbacks; set a barrier flag).</p>
</li>
<li>
<p>For each time step <span class="arithmatex">\(k=1,\dots,N\)</span>:</p>
<ul>
<li>
<p>Generate a standard normal random number <span class="arithmatex">\(Z_k\)</span> (or a vector for multiple assets).</p>
</li>
<li>
<p>Update <span class="arithmatex">\(S\)</span> via the exact GBM discretization:</p>
</li>
</ul>
<p>$$
   S \leftarrow S \times \exp\left[(r - \tfrac{\sigma^2}{2})\Delta t + \sigma \sqrt{\Delta t} Z_k\right].
   $$</p>
<ul>
<li>Update path statistics:</li>
<li><strong>Asian</strong>: accumulate the sum, <span class="arithmatex">\(\text{sum} \leftarrow \text{sum} + S\)</span>.</li>
<li><strong>Lookback</strong>: update maximum and minimum, <span class="arithmatex">\(\text{max} \leftarrow \max(\text{max}, S)\)</span>, <span class="arithmatex">\(\text{min} \leftarrow \min(\text{min}, S)\)</span>.</li>
<li><strong>Barrier</strong>: if the barrier is breached, set a flag and break out of the loop (for knock‑out options) or record the crossing (for knock‑in options).</li>
</ul>
</li>
<li>
<p>After the final step, compute the payoff:</p>
<ul>
<li>Arithmetic Asian call: <span class="arithmatex">\(h_m = \max\left(\tfrac{\text{sum}}{N+1} - K, 0\right)\)</span>.</li>
<li>Lookback call: <span class="arithmatex">\(h_m = \max(\text{max} - K, 0)\)</span>.</li>
<li>Up‑and‑out call: <span class="arithmatex">\(h_m = \max(S - K, 0)\)</span> if no barrier breach; else <span class="arithmatex">\(0\)</span>.</li>
</ul>
</li>
<li>
<p>Discount the payoff by <span class="arithmatex">\(e^{-rT}\)</span> and store it.</p>
</li>
<li>
<p><strong>Average payoffs.</strong> After simulating all paths, compute the estimator <span class="arithmatex">\(\hat{V}_0 = \frac{1}{M} \sum_{m=1}^M e^{-rT} h_m\)</span> and estimate the standard error.</p>
</li>
</ol>
<p>Monte‑Carlo’s power lies in this modularity: to price a new path‑dependent option, one changes only the path statistic and payoff computation.</p>
<hr />
<h3 id="implementation-nuances"><strong>Implementation nuances</strong></h3>
<ul>
<li>
<p><strong>Memory management:</strong> For path‑dependent options one might need to store entire paths, but most statistics (sum, max, min, barrier flag) can be updated incrementally, avoiding storage of all intermediate prices.</p>
</li>
<li>
<p><strong>Barrier monitoring:</strong> Because the asset price is only observed at discrete times, it might “jump” over a barrier between steps. To reduce discretization error, one can use <strong>Brownian bridge interpolation</strong>: given <span class="arithmatex">\(S_{t_k}\)</span> and <span class="arithmatex">\(S_{t_{k+1}}\)</span>, the conditional distribution of <span class="arithmatex">\(\log S_t\)</span> for <span class="arithmatex">\(t \in [t_k, t_{k+1}]\)</span> is Gaussian with mean linear in time. One can compute the probability of crossing the barrier during <span class="arithmatex">\([t_k,t_{k+1}]\)</span> and adjust the payoff accordingly.</p>
</li>
<li>
<p><strong>Variance and rare events:</strong> For knock‑in options or out‑of‑the‑money lookbacks, the payoff distribution is skewed with fat tails because the option pays only if a rare event occurs. <strong>Importance sampling</strong> can bias the simulation toward barrier crossings or extreme maxima, with weights adjusted to correct for the change of measure. This reduces variance but requires careful design.</p>
</li>
<li>
<p><strong>Multi‑asset path dependence:</strong> For basket options or spread options, one must track combinations of asset prices. For example, a basket call with weights <span class="arithmatex">\(w_i\)</span> has payoff <span class="arithmatex">\(\max\left(\sum_i w_i S_T^{(i)} - K, 0\right)\)</span>. In this case, correlation among assets plays a crucial role (§4.2.5).</p>
</li>
</ul>
<hr />
<h3 id="illustrative-examples"><strong>Illustrative examples</strong></h3>
<ol>
<li><strong>Arithmetic Asian call:</strong></li>
</ol>
<p>Let <span class="arithmatex">\(S_0=100\)</span>, <span class="arithmatex">\(K=100\)</span>, <span class="arithmatex">\(r=0.05\)</span>, <span class="arithmatex">\(\sigma=0.2\)</span>, <span class="arithmatex">\(T=1\)</span> year. Suppose we simulate with <span class="arithmatex">\(\Delta t = 1/252\)</span> (daily steps) and <span class="arithmatex">\(M=50{,}000\)</span>. The arithmetic mean is computed over 253 prices. The Monte‑Carlo price may converge to around $5.60 (this depends on the parameters and can be compared with analytic approximations or control variate estimates). Reducing <span class="arithmatex">\(\Delta t\)</span> to <span class="arithmatex">\(1/365\)</span> (daily steps) might alter the price slightly; a convergence test ensures stability.</p>
<ol>
<li><strong>Up‑and‑out barrier option:</strong></li>
</ol>
<p>Consider an up‑and‑out call with strike <span class="arithmatex">\(K=100\)</span>, barrier <span class="arithmatex">\(B=130\)</span>, same parameters as above. If the price ever exceeds 130 before maturity, the payoff is zero. The barrier significantly reduces the option’s value compared to a plain call; Monte‑Carlo simulation must carefully check barrier crossings at each step or use Brownian bridge adjustment.</p>
<ol>
<li><strong>Lookback put:</strong></li>
</ol>
<p>A fixed strike lookback put with strike <span class="arithmatex">\(K=100\)</span> pays <span class="arithmatex">\(\max(K - M_{\min}, 0)\)</span>, where <span class="arithmatex">\(M_{\min}\)</span> is the minimum asset price. It is valuable if the asset can dip far below the strike. Monte‑Carlo simulation captures the distribution of minima; pricing depends on the volatility and the likelihood of large downward excursions.</p>
<p>These examples illustrate the variety of path‑dependent payoffs and how the Monte‑Carlo framework can handle them by augmenting the simulation with appropriate path functionals.</p>
<hr />
<h3 id="why-path-dependence-matters"><strong>Why path dependence matters</strong></h3>
<p>Path‑dependent options allow fine‑grained hedging and payoff structuring. For instance:</p>
<ul>
<li>Commodity producers use Asian options to hedge average prices rather than spot prices, matching their revenue streams.</li>
<li>Barrier options enable cheaper premiums by knocking out the option if an adverse price move occurs, making them attractive to traders seeking conditional protection.</li>
<li>Lookback options give the holder the right to “look back” at the best (or worst) price during the contract, providing built‑in optimisation.</li>
</ul>
<p>However, the complexity of these payoffs means that intuitive reasoning or simple formulas are inadequate; rigorous simulation or advanced numerical methods (PDEs, transform techniques) are required. Monte‑Carlo shines in this domain because it can incorporate arbitrary payoff structures without intricate derivations. As we move to more intricate products in modern finance, the ability to simulate complex stochastic processes and compute expectations of non‑linear, path‑dependent functionals becomes ever more valuable.</p>
<hr />
<h2 id="44-variancereduction-techniques-antithetic-variates-and-control-variates"><strong>4.4 Variance‑Reduction Techniques: Antithetic Variates and Control Variates</strong></h2>
<hr />
<p>Monte‑Carlo estimators converge slowly: the standard error decreases at a rate proportional to <span class="arithmatex">\(1/\sqrt{M}\)</span>, where <span class="arithmatex">\(M\)</span> is the number of simulations. Achieving an extra digit of accuracy often requires an order‑of‑magnitude increase in runtime. <strong>Variance‑reduction techniques</strong> aim to lower the estimator’s variance without increasing bias, thereby obtaining the same accuracy with fewer simulations. Two of the simplest yet most powerful methods are <strong>antithetic variates</strong> and <strong>control variates</strong>. We also briefly discuss other techniques.</p>
<h3 id="antithetic-variates-negative-correlation-to-the-rescue"><strong>Antithetic variates: negative correlation to the rescue</strong></h3>
<p><strong>Basic idea.</strong> If two random variables <span class="arithmatex">\(X\)</span> and <span class="arithmatex">\(Y\)</span> are negatively correlated, their average <span class="arithmatex">\(\tfrac{1}{2}(X+Y)\)</span> has a variance smaller than that of <span class="arithmatex">\(X\)</span> alone. The antithetic variates technique exploits this by pairing each Monte‑Carlo sample with an “opposite” sample, thereby inducing negative correlation between paired payoffs.</p>
<p><strong>Application to GBM.</strong> In GBM simulation, each price path is driven by a sequence of standard normal variates <span class="arithmatex">\((Z_0,Z_1,\dots,Z_{N-1})\)</span>. To generate an antithetic path, we use <span class="arithmatex">\((-Z_0,-Z_1,\dots,-Z_{N-1})\)</span>. Because the GBM update is monotonic in <span class="arithmatex">\(Z_k\)</span>, the resulting asset path <span class="arithmatex">\(\tilde{S}_t\)</span> tends to move in the opposite direction relative to the original path, especially for short time horizons. For many payoff functions <span class="arithmatex">\(h(S)\)</span>, the payoffs of the original and antithetic paths are negatively correlated.</p>
<p><strong>Estimator.</strong> Suppose <span class="arithmatex">\(h_m\)</span> is the payoff computed from the <span class="arithmatex">\(m\)</span>‑th original path and <span class="arithmatex">\(\tilde{h}_m\)</span> from its antithetic counterpart. The antithetic estimator is</p>
<div class="arithmatex">\[
\hat{V}_0^{\mathrm{ant}} = e^{-rT} \frac{1}{2M} \sum_{m=1}^{M} \left(h_m + \tilde{h}_m\right).
\]</div>
<p>If <span class="arithmatex">\(\mathrm{Cov}(h_m,\tilde{h}_m)&lt;0\)</span>, the variance of <span class="arithmatex">\(\hat{V}_0^{\mathrm{ant}}\)</span> is</p>
<div class="arithmatex">\[
\mathrm{Var}[\hat{V}_0^{\mathrm{ant}}] = \frac{1}{4M}\left(\mathrm{Var}[h] + \mathrm{Var}[\tilde{h}] + 2\mathrm{Cov}(h,\tilde{h})\right),
\]</div>
<p>which is smaller than <span class="arithmatex">\(\mathrm{Var}[h]/M\)</span>. In practice, this technique often yields 10–50% variance reduction for vanilla options and moderate improvements for path‑dependent options.</p>
<p><strong>Example.</strong> Consider pricing a European call. For a given <span class="arithmatex">\(Z\)</span>, the payoff is <span class="arithmatex">\(h(S_T(Z)) = \max\left(S_0 e^{(r-\tfrac{\sigma^2}{2})T + \sigma \sqrt{T}Z}-K,0\right)\)</span>. Because the function <span class="arithmatex">\(h(S_T(Z))\)</span> is convex in <span class="arithmatex">\(Z\)</span>, <span class="arithmatex">\(h(Z)\)</span> and <span class="arithmatex">\(h(-Z)\)</span> are positively correlated, so antithetic variates may not offer dramatic variance reduction. For monotonic but nearly linear payoffs (e.g., deep in‑the‑money or deep out‑of‑the‑money options), the effect is small. However, for payoffs with significant curvature around the money (gamma), the negative correlation between <span class="arithmatex">\(S_T(Z)\)</span> and <span class="arithmatex">\(S_T(-Z)\)</span> leads to variance reduction.</p>
<p><strong>Extensions.</strong> Antithetic sampling can be combined with stratified sampling: partition the unit interval into pairs <span class="arithmatex">\((u,1-u)\)</span>, map them to normals via the inverse CDF, and ensure that each pair sums to one. For multi‑dimensional Brownian motions, one can create antithetic vectors by reflecting the entire vector or subsets of components.</p>
<hr />
<h3 id="control-variates-leveraging-known-expectations"><strong>Control variates: leveraging known expectations</strong></h3>
<p><strong>Concept.</strong> If we want to estimate <span class="arithmatex">\(\mu = \mathbb{E}[H]\)</span> but can find a random variable <span class="arithmatex">\(C\)</span> with known expectation <span class="arithmatex">\(\mathbb{E}[C]\)</span> that is correlated with <span class="arithmatex">\(H\)</span>, we can reduce variance by considering</p>
<div class="arithmatex">\[
H^\star = H + \beta \left(C_{\text{known}} - C\right),
\]</div>
<p>where <span class="arithmatex">\(C_{\text{known}} = \mathbb{E}[C]\)</span>. The new estimator is <span class="arithmatex">\(\mathbb{E}[H^\star] = \mu\)</span> for any choice of <span class="arithmatex">\(\beta\)</span>. The variance is</p>
<div class="arithmatex">\[
\mathrm{Var}[H^\star] = \mathrm{Var}[H] + \beta^2 \mathrm{Var}[C] - 2\beta \mathrm{Cov}(H,C),
\]</div>
<p>which is minimized when</p>
<div class="arithmatex">\[
\beta^\ast = \frac{\mathrm{Cov}(H,C)}{\mathrm{Var}(C)}.
\]</div>
<p>With this choice, the variance of <span class="arithmatex">\(H^\star\)</span> is <span class="arithmatex">\((1-\rho_{HC}^2)\mathrm{Var}[H]\)</span>, where <span class="arithmatex">\(\rho_{HC}\)</span> is the correlation coefficient between <span class="arithmatex">\(H\)</span> and <span class="arithmatex">\(C\)</span>. A correlation of 0.9 reduces variance by 81%.</p>
<p><strong>Procedure.</strong> In practice:</p>
<ol>
<li>Identify a control variate <span class="arithmatex">\(C\)</span> with known expected value <span class="arithmatex">\(C_{\text{known}}\)</span>. Ideally <span class="arithmatex">\(C\)</span> should be highly correlated with the target payoff <span class="arithmatex">\(H\)</span>.</li>
<li>Run the Monte‑Carlo simulation, recording both <span class="arithmatex">\(H_m\)</span> and <span class="arithmatex">\(C_m\)</span> for each path.</li>
<li>Estimate the sample covariance and variance:</li>
</ol>
<p>$$
   \hat{\mathrm{Cov}}(H,C) = \frac{1}{M-1}\sum_{m=1}^{M} (H_m - \bar{H})(C_m - \bar{C}),\quad
   \hat{\mathrm{Var}}(C) = \frac{1}{M-1}\sum_{m=1}^{M} (C_m - \bar{C})^2.
   $$</p>
<ol>
<li>Compute <span class="arithmatex">\(\beta^\ast = \hat{\mathrm{Cov}}(H,C) / \hat{\mathrm{Var}}(C)\)</span>.</li>
<li>Form the control‑variate estimator:</li>
</ol>
<p>$$
   \hat{V}<em _text_known="\text{known">0^{\mathrm{cv}} = e^{-rT} \left(\bar{H} + \beta^\ast [C</em>]\right),
   $$}} - \bar{C</p>
<p>where <span class="arithmatex">\(\bar{H}\)</span> and <span class="arithmatex">\(\bar{C}\)</span> are sample means of <span class="arithmatex">\(H_m\)</span> and <span class="arithmatex">\(C_m\)</span>.</p>
<p><strong>Example: arithmetic vs geometric Asian options.</strong> Suppose we want to price an arithmetic‑average Asian call but only the geometric‑average Asian call has a closed‑form price. Let <span class="arithmatex">\(H\)</span> be the arithmetic payoff and <span class="arithmatex">\(C\)</span> be the geometric payoff. Since both are functions of the same price path and the averages are strongly correlated, <span class="arithmatex">\(C\)</span> is an excellent control variate. One computes <span class="arithmatex">\(C_{\text{known}}\)</span> analytically, simulates <span class="arithmatex">\(H_m\)</span> and <span class="arithmatex">\(C_m\)</span> for each path, estimates <span class="arithmatex">\(\beta^\ast\)</span>, and forms <span class="arithmatex">\(\hat{V}_0^{\mathrm{cv}}\)</span>. Empirically this can reduce variance by an order of magnitude.</p>
<p><strong>Other control variates:</strong></p>
<ul>
<li><strong>Discounted asset price:</strong> For certain derivatives one may use <span class="arithmatex">\(C = S_T\)</span> or <span class="arithmatex">\(C = \exp(-rT) S_T\)</span>, whose expectation is <span class="arithmatex">\(S_0\)</span>. If the payoff is positively correlated with the terminal asset price, this can reduce variance.</li>
<li><strong>Term‑structure models:</strong> In interest rate models, the short rate integrated over time has known expectation; it can be a control variate for discount factors.</li>
</ul>
<hr />
<h3 id="stratified-sampling"><strong>Stratified sampling</strong></h3>
<p><strong>Idea.</strong> Divide the domain of the random input into mutually exclusive strata and sample from each. For example, if <span class="arithmatex">\(U \sim U(0,1)\)</span>, partition <span class="arithmatex">\([0,1]\)</span> into <span class="arithmatex">\(M\)</span> intervals <span class="arithmatex">\(I_m = [(m-1)/M, m/M)\)</span> and pick one uniformly random point <span class="arithmatex">\(u_m\)</span> from each interval. Map <span class="arithmatex">\(u_m\)</span> to a normal <span class="arithmatex">\(Z_m\)</span> via the inverse cumulative distribution function. By ensuring each stratum is sampled exactly once, stratified sampling reduces sampling error due to randomness in the distribution of <span class="arithmatex">\(U\)</span>.</p>
<p><strong>Application to Monte‑Carlo:</strong> When simulating <span class="arithmatex">\(M\)</span> paths, rather than drawing <span class="arithmatex">\(M\)</span> independent sequences of normals, one can assign each path a quasi‑random sequence using stratification. For multi‑dimensional problems, one can stratify along low‑dimensional projections (Latin hypercube sampling). This method often improves convergence for pricing European options and can be combined with antithetic variates.</p>
<hr />
<h3 id="importance-sampling"><strong>Importance sampling</strong></h3>
<p><strong>Problem:</strong> Some payoffs depend on rare events (e.g., deep out‑of‑the‑money options, barrier hits) that occur with low probability under the nominal measure, leading to high variance. <strong>Importance sampling</strong> changes the sampling distribution to overweight these rare events and adjusts the estimator by likelihood ratios to maintain unbiasedness.</p>
<p><strong>Implementation:</strong></p>
<ol>
<li><strong>Choose a new measure</strong> with density <span class="arithmatex">\(f^\ast\)</span> such that important regions (where the payoff is large) are sampled more frequently. For GBM, one might tilt the drift of the Brownian motion to push paths towards the barrier.</li>
<li><strong>Generate paths</strong> under <span class="arithmatex">\(f^\ast\)</span> and compute the likelihood ratio <span class="arithmatex">\(L = \frac{f}{f^\ast}\)</span> (Radon–Nikodym derivative). For Brownian motion with drift shift, the likelihood ratio is an exponential martingale.</li>
<li><strong>Compute the weighted payoff</strong>: <span class="arithmatex">\(H_m L_m\)</span> for each path. The estimator is <span class="arithmatex">\(\hat{V}_0 = e^{-rT}\frac{1}{M}\sum H_m L_m\)</span>.</li>
</ol>
<p>Choosing the optimal change of measure is problem‑specific and requires some analysis. For barrier options, Brownian bridge methods combined with importance sampling can drastically reduce variance.</p>
<hr />
<h3 id="quasimontecarlo-qmc"><strong>Quasi‑Monte‑Carlo (QMC)</strong></h3>
<p><strong>Concept.</strong> Instead of pseudorandom numbers, QMC uses deterministic low‑discrepancy sequences (Sobol’, Halton, Faure) that fill the unit hypercube more uniformly. The integration error of QMC can be <span class="arithmatex">\(O(M^{-1}(\log M)^d)\)</span> rather than <span class="arithmatex">\(O(M^{-1/2})\)</span>, where <span class="arithmatex">\(d\)</span> is the dimensionality (e.g., number of time steps). This improvement is significant for low or moderate dimensions.</p>
<p><strong>Caveats:</strong></p>
<ul>
<li>QMC sequences lose their low‑discrepancy properties in very high dimensions (e.g., thousands of time steps).</li>
<li>Randomized QMC (scrambled sequences) can provide unbiased estimators and error estimates.</li>
<li>Combining QMC with Brownian bridge construction (to reduce effective dimensionality) improves performance when simulating GBM.</li>
</ul>
<hr />
<h3 id="other-methods"><strong>Other methods</strong></h3>
<ul>
<li>
<p><strong>Moment matching:</strong> Adjust the generated random numbers so that sample moments (e.g., mean, variance) match theoretical moments. For example, ensure that the average of all <span class="arithmatex">\(Z_k\)</span> across paths is zero and their variance is one. This can reduce variance slightly but can be combined with antithetic sampling.</p>
</li>
<li>
<p><strong>Control variates with martingale representation:</strong> For certain options one can derive a representation of the payoff as an Itō integral plus a predictable process. This leads to control variates derived from the hedging portfolio. The Longstaff–Schwartz least‑squares approach for American options can be viewed in this light.</p>
</li>
<li>
<p><strong>Multilevel Monte‑Carlo:</strong> Instead of simulating all paths with a fine time discretization, simulate many coarse paths and a few fine paths. Combine their results to achieve a given error at lower cost. This method is powerful for SDEs where discretization error dominates.</p>
</li>
</ul>
<hr />
<h3 id="choosing-the-right-technique"><strong>Choosing the right technique</strong></h3>
<p>No single variance‑reduction method is universally superior. The choice depends on the payoff’s structure, the underlying dynamics and the desired accuracy:</p>
<ul>
<li><strong>Antithetic variates</strong> are easy to implement and beneficial for payoffs that are monotonic and symmetric in the driving noise. They incur zero additional computational cost beyond generating antithetic normals.</li>
<li><strong>Control variates</strong> offer dramatic improvements when a strongly correlated payoff with known expectation is available (e.g., geometric Asian vs arithmetic Asian). They require computing the control payoff in addition to the target payoff.</li>
<li><strong>Stratification and QMC</strong> help when the integrand is smooth and low‑dimensional, and are often used in conjunction with Brownian bridge constructions for path simulation.</li>
<li><strong>Importance sampling</strong> is essential for rare‑event problems such as deep out‑of‑the‑money barrier options or insurance losses but requires problem‑specific design.</li>
<li><strong>Multilevel Monte‑Carlo</strong> is attractive when discretization error is non‑negligible and can reduce the computational complexity from <span class="arithmatex">\(O(\epsilon^{-3})\)</span> to <span class="arithmatex">\(O(\epsilon^{-2})\)</span> for a desired root‑mean‑squared error <span class="arithmatex">\(\epsilon\)</span>.</li>
</ul>
<p>By applying these techniques thoughtfully, practitioners can reduce simulation time, improve precision and obtain reliable prices for even the most exotic derivatives. In the next and final section of this chapter, we will summarise how Monte‑Carlo option pricing connects to other stochastic simulations and set the stage for the stochastic modeling of biological systems in Chapter 5.</p>
<hr />
<h2 id="45-chapter-summary-bridge-to-chapter-5"><strong>4.5 Chapter Summary &amp; Bridge to Chapter 5</strong></h2>
<hr />
<h3 id="review-of-key-concepts"><strong>Review of key concepts</strong></h3>
<p><strong>A unified perspective on simulation.</strong> In previous chapters we learned how stochastic sampling can solve intractable integrals in physics (Ising models) and gauge theory (Wilson loops). In Chapter 4 we transported this philosophy to <strong>financial mathematics</strong>, showing that seemingly disparate domains share a common computational backbone: Monte‑Carlo methods. Let’s recap the core ideas:</p>
<ol>
<li>
<p><strong>Risk‑neutral valuation.</strong> By invoking the absence of arbitrage, we replaced the real‑world drift of an asset with the risk‑free rate <span class="arithmatex">\(r\)</span>, allowing derivative prices to be expressed as discounted expectations under a <strong>risk‑neutral measure</strong>. This parallels how partition functions weight states by <span class="arithmatex">\(e^{-\beta E}\)</span> in statistical mechanics. The risk‑neutral measure is to finance what the Boltzmann distribution is to physics: a probability measure that encodes equilibrium pricing.</p>
</li>
<li>
<p><strong>Modelling asset paths via SDEs.</strong> We modelled the underlying asset as a geometric Brownian motion (GBM), capturing the log‑normal distribution of stock prices. We discussed exact and Euler–Maruyama discretizations and highlighted the importance of choosing appropriate time steps and calibrating parameters <span class="arithmatex">\((r,\sigma,S_0)\)</span> to market data.</p>
</li>
<li>
<p><strong>Simulation of path‑dependent payoffs.</strong> Exotic options like Asian, lookback and barrier options depend on the whole price path. Monte‑Carlo simulation shines here because it naturally tracks path functionals (averages, maxima, minima and barrier crossings). We demonstrated algorithms that accumulate these statistics on the fly and compute discounted payoffs.</p>
</li>
<li>
<p><strong>Variance‑reduction techniques.</strong> Naïve Monte‑Carlo estimators converge slowly (<span class="arithmatex">\(O(M^{-1/2})\)</span>). We introduced <strong>antithetic variates</strong> and <strong>control variates</strong>, showing how negative correlation and known expectations can dramatically reduce variance. We briefly discussed stratified sampling, importance sampling, quasi‑Monte‑Carlo, and multilevel Monte‑Carlo, emphasising that these tools are crucial for efficient pricing of rare or complex events.</p>
</li>
<li>
<p><strong>Comparison with other numerical methods.</strong> While Monte‑Carlo is flexible, other techniques—tree methods, finite difference schemes and transform methods—may be preferable for certain options. Monte‑Carlo is particularly advantageous when the payoff depends on multiple risk factors or path features and when other methods become unwieldy.</p>
</li>
<li>
<p><strong>Error analysis and diagnostics.</strong> Throughout, we stressed the importance of checking convergence with respect to both the number of paths and the time discretization, verifying that simulated distributions match theoretical moments, and computing confidence intervals using binning or bootstrap methods.</p>
</li>
</ol>
<hr />
<h3 id="broader-implications-and-interdisciplinary-insights"><strong>Broader implications and interdisciplinary insights</strong></h3>
<p>This chapter illustrates how <strong>probability theory and stochastic processes</strong> underpin modern finance just as they underpin statistical mechanics. Concepts like Brownian motion, martingales, path integrals and measure changes are shared across disciplines. There are also instructive contrasts:</p>
<ul>
<li>In physics, we sample from a <strong>Boltzmann distribution</strong> to compute macroscopic observables; in finance, we sample from a risk‑neutral distribution to compute fair prices.</li>
<li>The <strong>energy</strong> in physics becomes the <strong>log‑likelihood ratio</strong> in finance when performing importance sampling; both modulate the probability weight of states or paths.</li>
<li><strong>Correlation</strong> plays a dual role: coupling in spin systems corresponds to asset correlation in baskets. Generating correlated normal variates via Cholesky decomposition in finance mirrors generating correlated fields in multi‑component physical systems.</li>
</ul>
<p>Recognizing these parallels fosters conceptual transfer: techniques like antithetic sampling and control variates are directly inspired by variance‑reduction methods in MCMC for physical systems.</p>
<hr />
<h3 id="limitations-and-outlook"><strong>Limitations and outlook</strong></h3>
<p>While our focus was on GBM and log‑normal dynamics, real markets exhibit features like jumps, stochastic volatility, mean reversion and fat tails. Extending Monte‑Carlo methods to these models requires simulating additional stochastic factors (e.g., volatility processes in Heston models) or jump processes, and often demands more sophisticated variance‑reduction. Moreover, market frictions, liquidity constraints and behavioural factors may violate risk‑neutral assumptions. Hence, Monte‑Carlo simulation is not a cure‑all; it is a powerful tool when used judiciously.</p>
<p>On the computational side, Monte‑Carlo remains resource intensive. However, advances in parallel processing, GPU computing and quasi‑Monte‑Carlo techniques continue to push the boundaries of real‑time pricing and risk management.</p>
<hr />
<h3 id="bridge-to-chapter-5-from-financial-noise-to-biological-noise"><strong>Bridge to Chapter 5: from financial noise to biological noise</strong></h3>
<p>In closing this chapter, we have mastered the art of simulating continuous‑time stochastic processes and pricing path‑dependent financial derivatives. The next chapter transports us to a very different realm: <strong>stochastic systems biology</strong>, where the randomness arises from <strong>discrete molecular events</strong> inside cells.</p>
<p>In biological systems:</p>
<ul>
<li>The state space consists of molecule counts (integers), not continuous asset prices.</li>
<li>Reactions occur randomly according to <strong>propensities</strong> rather than Brownian motion.</li>
<li>The fundamental algorithm is the <strong>Gillespie Stochastic Simulation Algorithm (SSA)</strong>, which samples reaction times and updates molecule counts one jump at a time. It is the discrete analogue of simulating GBM paths.</li>
</ul>
<p>Yet the overarching themes persist:</p>
<ul>
<li>We need to simulate many possible trajectories to understand the distribution of outcomes (gene expression levels, protein counts).</li>
<li>We must compute expectations of path‑dependent quantities (time to reach a threshold, total number of proteins produced).</li>
<li>Variance‑reduction and efficiency considerations remain crucial, especially when modelling rare events like transcriptional bursts or signalling cascades.</li>
</ul>
<p>Chapter 5 will introduce the Gillespie algorithm and show how intrinsic molecular noise gives rise to striking biological phenomena. Just as we used Monte‑Carlo to price exotic options by sampling price paths, we will use Monte‑Carlo to simulate biochemical reaction paths and illuminate the stochastic nature of life at the molecular scale.</p>
<hr />
<h2 id="references"><strong>References</strong></h2>
<p>[1] F. Black and M. Scholes, "The Pricing of Options and Corporate Liabilities," <em>Journal of Political Economy</em> <strong>81</strong>, 637–654 (1973).<br />
The foundational paper deriving the Black-Scholes formula for European options under geometric Brownian motion.</p>
<p>[2] P. Glasserman, <em>Monte Carlo Methods in Financial Engineering</em>, Springer (2004).<br />
Comprehensive textbook covering Monte Carlo simulation for derivative pricing, variance reduction, and quasi-Monte Carlo methods.</p>
<p>[3] J. C. Hull, <em>Options, Futures, and Other Derivatives</em>, 11<sup>th</sup> edition, Pearson (2021).<br />
Standard reference for financial derivatives, including numerical methods and practical implementation.</p>
<p>[4] M. Broadie and P. Glasserman, "Pricing American-style securities using simulation," <em>Journal of Economic Dynamics and Control</em> <strong>21</strong>, 1323–1352 (1997).<br />
Early work on Monte Carlo methods for American options with path dependence.</p>
<p>[5] M. Giles, "Multilevel Monte Carlo path simulation," <em>Operations Research</em> <strong>56</strong>, 607–617 (2008).<br />
Introduction of multilevel Monte Carlo for variance reduction in SDE simulation with applications to finance.</p>
<p>[6] B. Lapeyre and E. Temam, "Competitive Monte Carlo methods for the pricing of Asian options," <em>Journal of Computational Finance</em> <strong>5</strong>, 39–57 (2001).<br />
Detailed study of control variates and variance reduction for Asian option pricing.</p>
<p>[7] P. Boyle, M. Broadie, and P. Glasserman, "Monte Carlo methods for security pricing," <em>Journal of Economic Dynamics and Control</em> <strong>21</strong>, 1267–1321 (1997).<br />
Comprehensive survey of Monte Carlo techniques in finance, including antithetic variates and quasi-random sequences.</p>
<p>[8] S. Heston, "A Closed-Form Solution for Options with Stochastic Volatility," <em>Review of Financial Studies</em> <strong>6</strong>, 327–343 (1993).<br />
Introduces the Heston model for stochastic volatility, widely used in Monte Carlo simulations for exotic options.</p>
<p>[9] L. Andersen and R. Brotherton-Ratcliffe, "The equity option volatility smile: an implicit finite-difference approach," <em>Journal of Computational Finance</em> <strong>1</strong>, 5–38 (1998).<br />
Discussion of discretization methods and Brownian bridge techniques for barrier options.</p>
<p>[10] I. Karatzas and S. Shreve, <em>Brownian Motion and Stochastic Calculus</em>, 2<sup>nd</sup> edition, Springer (1998).<br />
Rigorous mathematical foundation for stochastic differential equations and martingale theory underlying derivative pricing.</p>









  




                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../../chapter-3/Chapter-3-Essay/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Chapter-3 Lattice Gauge Theory">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Chapter-3 Lattice Gauge Theory
              </div>
            </div>
          </a>
        
        
          
          <a href="../../chapter-5/Chapter-5-Essay/" class="md-footer__link md-footer__link--next" aria-label="Next: Chapter-5 Stochastic Systems Biology">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Chapter-5 Stochastic Systems Biology
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://bigbookofcomputing.github.io" target="_blank" rel="noopener" title="bigbookofcomputing.github.io" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://x.com/bigbookofcomputing" target="_blank" rel="noopener" title="x.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M459.4 151.7c.3 4.5.3 9.1.3 13.6 0 138.7-105.6 298.6-298.6 298.6-59.5 0-114.7-17.2-161.1-47.1 8.4 1 16.6 1.3 25.3 1.3 49.1 0 94.2-16.6 130.3-44.8-46.1-1-84.8-31.2-98.1-72.8 6.5 1 13 1.6 19.8 1.6 9.4 0 18.8-1.3 27.6-3.6-48.1-9.7-84.1-52-84.1-103v-1.3c14 7.8 30.2 12.7 47.4 13.3-28.3-18.8-46.8-51-46.8-87.4 0-19.5 5.2-37.4 14.3-53C87.4 130.8 165 172.4 252.1 176.9c-1.6-7.8-2.6-15.9-2.6-24C249.5 95.1 296.3 48 354.4 48c30.2 0 57.5 12.7 76.7 33.1 23.7-4.5 46.5-13.3 66.6-25.3-7.8 24.4-24.4 44.8-46.1 57.8 21.1-2.3 41.6-8.1 60.4-16.2-14.3 20.8-32.2 39.3-52.6 54.3"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.facebook.com/bigbookofcomputing" target="_blank" rel="noopener" title="www.facebook.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M512 256C512 114.6 397.4 0 256 0S0 114.6 0 256c0 120 82.7 220.8 194.2 248.5V334.2h-52.8V256h52.8v-33.7c0-87.1 39.4-127.5 125-127.5 16.2 0 44.2 3.2 55.7 6.4V172c-6-.6-16.5-1-29.6-1-42 0-58.2 15.9-58.2 57.2V256h83.6l-14.4 78.2H287v175.9C413.8 494.8 512 386.9 512 256"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/bigbookofcomputing" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.youtube.com/@big-book-of-computing" target="_blank" rel="noopener" title="www.youtube.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M549.7 124.1c-6.2-23.7-24.8-42.3-48.3-48.6C458.9 64 288.1 64 288.1 64S117.3 64 74.7 75.5c-23.5 6.3-42 24.9-48.3 48.6C15 167 15 256.4 15 256.4s0 89.4 11.4 132.3c6.3 23.6 24.8 41.5 48.3 47.8C117.3 448 288.1 448 288.1 448s170.8 0 213.4-11.5c23.5-6.3 42-24.2 48.3-47.8 11.4-42.9 11.4-132.3 11.4-132.3s0-89.4-11.4-132.3zM232.2 337.6V175.2l142.7 81.2z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
      <div class="md-consent" data-md-component="consent" id="__consent" hidden>
        <div class="md-consent__overlay"></div>
        <aside class="md-consent__inner">
          <form class="md-consent__form md-grid md-typeset" name="consent">
            


  


<h4>Cookie consent</h4>
<p>We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of our documentation and whether users find what they're searching for. With your consent, you're helping us to make our documentation better.</p>
<input class="md-toggle" type="checkbox" id="__settings" >
<div class="md-consent__settings">
  <ul class="task-list">
    
    
      
        
  
  
    
    
  
  <li class="task-list-item">
    <label class="task-list-control">
      <input type="checkbox" name="analytics" checked>
      <span class="task-list-indicator"></span>
      Google Analytics
    </label>
  </li>

      
    
    
      
        
  
  
    
    
  
  <li class="task-list-item">
    <label class="task-list-control">
      <input type="checkbox" name="github" checked>
      <span class="task-list-indicator"></span>
      GitHub
    </label>
  </li>

      
    
    
  </ul>
</div>
<div class="md-consent__controls">
  
    
      <button class="md-button md-button--primary">Accept</button>
    
    
    
  
    
    
    
      <label class="md-button" for="__settings">Manage settings</label>
    
  
</div>
          </form>
        </aside>
      </div>
      <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout((function(){document.querySelector("[data-md-component=consent]").hidden=!1}),250);var form=document.forms.consent;for(var action of["submit","reset"])form.addEventListener(action,(function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map((function(e){return[e,!0]})))),location.hash="",location.reload()}))</script>
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../..", "features": ["announce.dismiss", "content.action.edit", "content.action.view", "content.code.annotate", "content.code.copy", "content.tooltips", "navigation.footer", "navigation.indexes", "navigation.sections", "navigation.tabs", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="../../../static/mathjax-config.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/3.2.0/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>